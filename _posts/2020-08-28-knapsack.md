---
layout: post
title: èƒŒåŒ…é—®é¢˜
date: 2020-08-28
tags: leetcode    
---


èƒŒåŒ…é—®é¢˜æ€»ç»“
===

Index
---
<!-- TOC -->

- [01èƒŒåŒ…](#01èƒŒåŒ…)
- [å®Œå…¨èƒŒåŒ…](#å®Œå…¨èƒŒåŒ…)
- [å¤šé‡èƒŒåŒ…](#å¤šé‡èƒŒåŒ…)
- [æ··åˆèƒŒåŒ…](#æ··åˆèƒŒåŒ…)
- [äºŒç»´è´¹ç”¨çš„èƒŒåŒ…é—®é¢˜](#äºŒç»´è´¹ç”¨çš„èƒŒåŒ…é—®é¢˜)
- [åˆ†ç»„èƒŒåŒ…](#åˆ†ç»„èƒŒåŒ…)
- [æœ‰ä¾èµ–çš„èƒŒåŒ…é—®é¢˜](#æœ‰ä¾èµ–çš„èƒŒåŒ…é—®é¢˜)

<!-- /TOC -->



### 01èƒŒåŒ…


é¢˜ç›®æè¿°ï¼šæœ‰ N ä»¶ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ Vçš„èƒŒåŒ…ã€‚æ¯ä»¶ç‰©å“åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚ç¬¬ iä»¶ç‰©å“çš„ä½“ç§¯æ˜¯ viï¼Œä»·å€¼æ˜¯ wiã€‚æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿è¿™äº›ç‰©å“çš„æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚

è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚

æ€è·¯ï¼šåŠ¨æ€è§„åˆ’ï¼Œå¯¹äºæ¯ä¸€ä»¶ç‰©å“éå†èƒŒåŒ…å®¹é‡ï¼Œå½“èƒŒåŒ…å¯å®¹çº³å€¼å¤§äºç­‰äºå½“å‰ç‰©å“ï¼Œä¸ä¹‹å‰å·²æ”¾è¿›å»çš„ç‰©å“æ‰€å¾—ä»·å€¼è¿›è¡Œå¯¹æ¯”ï¼Œè€ƒè™‘æŠŠæ˜¯å¦éœ€è¦ç½®æ¢ã€‚

çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼šå®šä¹‰dp[i][j]ï¼šå‰iä¸ªç‰©å“ï¼ŒèƒŒåŒ…å®¹é‡jä¸‹çš„æœ€ä¼˜è§£
>* ï¼ˆ1ï¼‰å½“å‰èƒŒåŒ…å®¹é‡ä¸å¤Ÿï¼Œä¸ºå‰ğ‘–âˆ’1ä¸ªç‰©å“æœ€ä¼˜è§£ï¼šj< w[i]æ—¶ï¼Œæœ‰ ```dp[i][j] = dp[i-1][j]```
>* ï¼ˆ2ï¼‰å½“å‰èƒŒåŒ…å®¹é‡å¤Ÿï¼Œåˆ¤æ–­é€‰è¿˜æ˜¯ä¸é€‰ç¬¬iä¸ªç‰©å“ï¼šj >= w[i]æ—¶ï¼Œ
    é€‰è¯¥ç‰©å“:
    ```dp[i][j] = dp[i-1][j-w[i]] + v[i]```
    ä¸é€‰è¯¥ç‰©å“:
    ```dp[i][j]=dp[i-1][j]```

```c++
for (int i = 1; i <= n; ++i) {
    for (int j = 0; j <= m; ++j) {
        dp[i][j] = dp[i - 1][j];
        if (j >= v[i])
            dp[i][j] = max(dp[i][j], dp[i - 1][j - v[i]] + w[i]);
    }
}
int ans = 0;
for (int i = 0; i <= m; ++j) 
  ans = max(ans, dp[n][i])
```

ä¸€ç»´ä¼˜åŒ–
```c++
for (int i = 1; i <= n; ++i) {
    for (int j = m; j >= v[i]; --j) 
       dp[j] = max(dp[i], dp[j - v[i]] + w[i]);
}
// æœ€å¤§ä»·å€¼ä¸ºf[m]
```

**ä½“ç§¯æ°å¥½ä¸ºmçš„æœ€å¤§ä»·å€¼**

>*ä¿®æ”¹åˆå§‹åŒ–ç­–ç•¥ã€‚dp[0] = 0, dp[i] = INT_MIN, i != 0


### å®Œå…¨èƒŒåŒ…

>* é¢˜ç›®æè¿°ï¼šæœ‰ N ç§ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ Vçš„èƒŒåŒ…ï¼Œæ¯ç§ç‰©å“éƒ½æœ‰æ— é™ä»¶å¯ç”¨ã€‚ç¬¬ iç§ç‰©å“çš„ä½“ç§¯æ˜¯ viï¼Œä»·å€¼æ˜¯ wiã€‚æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿è¿™äº›ç‰©å“çš„æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚

>* æ€è·¯ï¼š

f[i] è¡¨ç¤ºä½“ç§¯ä¸ºiçš„æƒ…å†µä¸‹ï¼Œæœ€å¤§ä»·å€¼æ˜¯å¤šå°‘
res = max(f[0,...,m])

```c++
for (int i = 1; i <= n; ++i) {
    for (int j = v[i]; j <= m; ++j) {
        dp[j] = max(dp[j], dp[j - v[i]] + w[i]);
    }
}
```


### å¤šé‡èƒŒåŒ…


é¢˜ç›®æè¿°ï¼šæœ‰Nç§ç‰©å“å’Œä¸€ä¸ªå®¹é‡ä¸ºVçš„èƒŒåŒ…ã€‚ç¬¬iç§ç‰©å“æœ€å¤šæœ‰n[i]ä»¶å¯ç”¨ï¼Œæ¯ä»¶è´¹ç”¨æ˜¯c[i]ï¼Œä»·å€¼æ˜¯w[i]ã€‚æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…å¯ä½¿è¿™äº›ç‰©å“çš„è´¹ç”¨æ€»å’Œä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”ä»·å€¼æ€»å’Œæœ€å¤§ã€‚

åŸºæœ¬ç®—æ³•

è¿™é¢˜ç›®å’Œå®Œå…¨èƒŒåŒ…é—®é¢˜å¾ˆç±»ä¼¼ã€‚åŸºæœ¬çš„æ–¹ç¨‹åªéœ€å°†å®Œå…¨èƒŒåŒ…é—®é¢˜çš„æ–¹ç¨‹ç•¥å¾®ä¸€æ”¹å³å¯ï¼Œå› ä¸ºå¯¹äºç¬¬iç§ç‰©å“æœ‰n[i]+1ç§ç­–ç•¥ï¼šå–0ä»¶ï¼Œå–1ä»¶â€¦â€¦å–n[i]ä»¶ã€‚ä»¤f[i][v]è¡¨ç¤ºå‰iç§ç‰©å“æ°æ”¾å…¥ä¸€ä¸ªå®¹é‡ä¸ºvçš„èƒŒåŒ…çš„æœ€å¤§æƒå€¼ï¼Œåˆ™æœ‰çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š

f[i][v]=max{f[i-1][v-k*c[i]]+k*w[i]|0<=k<=n[i]}

å¤æ‚åº¦æ˜¯O(V*Î£n[i])ã€‚

è½¬åŒ–ä¸º01èƒŒåŒ…é—®é¢˜

å¦ä¸€ç§å¥½æƒ³å¥½å†™çš„åŸºæœ¬æ–¹æ³•æ˜¯è½¬åŒ–ä¸º01èƒŒåŒ…æ±‚è§£ï¼šæŠŠç¬¬iç§ç‰©å“æ¢æˆn[i]ä»¶01èƒŒåŒ…ä¸­çš„ç‰©å“ï¼Œåˆ™å¾—åˆ°äº†ç‰©å“æ•°ä¸ºÎ£n[i]çš„01èƒŒåŒ…é—®é¢˜ï¼Œç›´æ¥æ±‚è§£ï¼Œå¤æ‚åº¦ä»ç„¶æ˜¯O(V*Î£n[i])ã€‚

ä½†æ˜¯æˆ‘ä»¬æœŸæœ›å°†å®ƒè½¬åŒ–ä¸º01èƒŒåŒ…é—®é¢˜ä¹‹åèƒ½å¤Ÿåƒå®Œå…¨èƒŒåŒ…ä¸€æ ·é™ä½å¤æ‚åº¦ã€‚ä»ç„¶è€ƒè™‘äºŒè¿›åˆ¶çš„æ€æƒ³ï¼Œæˆ‘ä»¬è€ƒè™‘æŠŠç¬¬iç§ç‰©å“æ¢æˆè‹¥å¹²ä»¶ç‰©å“ï¼Œä½¿å¾—åŸé—®é¢˜ä¸­ç¬¬iç§ç‰©å“å¯å–çš„æ¯ç§ç­–ç•¥â€”â€”å–0..n[i]ä»¶â€”â€”å‡èƒ½ç­‰ä»·äºå–è‹¥å¹²ä»¶ä»£æ¢ä»¥åçš„ç‰©å“ã€‚å¦å¤–ï¼Œå–è¶…è¿‡n[i]ä»¶çš„ç­–ç•¥å¿…ä¸èƒ½å‡ºç°ã€‚

æ–¹æ³•æ˜¯ï¼šå°†ç¬¬iç§ç‰©å“åˆ†æˆè‹¥å¹²ä»¶ç‰©å“ï¼Œå…¶ä¸­æ¯ä»¶ç‰©å“æœ‰ä¸€ä¸ªç³»æ•°ï¼Œè¿™ä»¶ç‰©å“çš„è´¹ç”¨å’Œä»·å€¼å‡æ˜¯åŸæ¥çš„è´¹ç”¨å’Œä»·å€¼ä¹˜ä»¥è¿™ä¸ªç³»æ•°ã€‚ä½¿è¿™äº›ç³»æ•°åˆ†åˆ«ä¸º1,2,4,...,2^(k-1),n[i]-2^k+1ï¼Œä¸”kæ˜¯æ»¡è¶³n[i]-2^k+1>0çš„æœ€å¤§æ•´æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœn[i]ä¸º13ï¼Œå°±å°†è¿™ç§ç‰©å“åˆ†æˆç³»æ•°åˆ†åˆ«ä¸º1,2,4,6çš„å››ä»¶ç‰©å“ã€‚


```c++
for (int i = 0; i < n; ++i) {
  for (int j = m; j >= 0; ++j) {
    for (int k = 1; k <= n[i] && k * v[i] <= j; ++k) 
      f[j] = max(f[j], f[j - k * v[i]] + k * w[i]);
  }
}
```

ä¼˜åŒ–
äºŒè¿›åˆ¶æ‹†è§£
```c++
struct Good {
  int v, w;
};
vector<Good> goods;
for (int i = 0; i < n; ++i)
{
  for (int k = 1; k <= n[i]; k *= 2) {
    n[i] -= k;
    goods.push_back({v[i] * k, w[i] * k});
  }
  if (n[i] > 0) goods.push_back({v[i] * n[i], w[i] * n[i]});
}

for (auto good :goods) {
  for (int j = m; j >= good.v; --j) {
    f[j] = max(f[j], f[j - good.v] + good.w);
  }
}
```

### æ··åˆèƒŒåŒ…

æœ‰ N ç§ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ V çš„èƒŒåŒ…ã€‚

ç‰©å“ä¸€å…±æœ‰ä¸‰ç±»ï¼š

>* ç¬¬ä¸€ç±»ç‰©å“åªèƒ½ç”¨1æ¬¡ï¼ˆ01èƒŒåŒ…ï¼‰ï¼›
>* ç¬¬äºŒç±»ç‰©å“å¯ä»¥ç”¨æ— é™æ¬¡ï¼ˆå®Œå…¨èƒŒåŒ…ï¼‰ï¼›
>* ç¬¬ä¸‰ç±»ç‰©å“æœ€å¤šåªèƒ½ç”¨ si æ¬¡ï¼ˆå¤šé‡èƒŒåŒ…ï¼‰ï¼›
æ¯ç§ä½“ç§¯æ˜¯ viï¼Œä»·å€¼æ˜¯ wiã€‚

æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿ç‰©å“ä½“ç§¯æ€»å’Œä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”ä»·å€¼æ€»å’Œæœ€å¤§ã€‚
è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚

**è¾“å…¥æ ¼å¼**
ç¬¬ä¸€è¡Œä¸¤ä¸ªæ•´æ•°ï¼ŒNï¼ŒVï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç‰©å“ç§æ•°å’ŒèƒŒåŒ…å®¹ç§¯ã€‚

æ¥ä¸‹æ¥æœ‰ N è¡Œï¼Œæ¯è¡Œä¸‰ä¸ªæ•´æ•° vi,wi,siï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç¬¬ i ç§ç‰©å“çš„ä½“ç§¯ã€ä»·å€¼å’Œæ•°é‡ã€‚

si=âˆ’1 è¡¨ç¤ºç¬¬ i ç§ç‰©å“åªèƒ½ç”¨1æ¬¡ï¼›
si=0 è¡¨ç¤ºç¬¬ i ç§ç‰©å“å¯ä»¥ç”¨æ— é™æ¬¡ï¼›
si>0 è¡¨ç¤ºç¬¬ i ç§ç‰©å“å¯ä»¥ä½¿ç”¨ si æ¬¡ï¼›

**è¾“å‡ºæ ¼å¼**
è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å¤§ä»·å€¼ã€‚

```c++
#include <bits/stdc++.h>
using namespace std;

const int N = 1010;
int n, m, f[N];

struct Thing {
    int kind, v, w;
};

vector<Thing> things;

int main() {
    cin >> n>>m;
    for(int i = 0;i<n;i++) {
        int v, w, s;
        cin >> v >> w >> s;
        if(s < 0) {
            things.push_back({-1,v,w});
        }else if(s == 0) things.push_back({0,v,w});
        else{
            for(int k = 1;k <= s; k*=2){
                s -=k;
                things.push_back({-1,v*k,w*k});
            }
            if(s > 0) things.push_back({-1,v*s,w*s});
        }
    }

    for(auto thing:things) {
        if(thing.kind < 0){
            for(int j = m;j >= thing.v;j--)   
              f[j] = max(f[j],f[j-thing.v]+thing.w);
        }else{
            for(int j = thing.v;j <= m;j++) 
              f[j] = max(f[j],f[j-thing.v]+thing.w);
        }
    }

    cout << f[m] << endl;
    return 0;
}
```


###  äºŒç»´è´¹ç”¨çš„èƒŒåŒ…é—®é¢˜

æœ‰ N ä»¶ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ V çš„èƒŒåŒ…ï¼ŒèƒŒåŒ…èƒ½æ‰¿å—çš„æœ€å¤§é‡é‡æ˜¯ Mã€‚

æ¯ä»¶ç‰©å“åªèƒ½ç”¨ä¸€æ¬¡ã€‚ä½“ç§¯æ˜¯ viï¼Œé‡é‡æ˜¯ miï¼Œä»·å€¼æ˜¯ wiã€‚

æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿ç‰©å“æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œæ€»é‡é‡ä¸è¶…è¿‡èƒŒåŒ…å¯æ‰¿å—çš„æœ€å¤§é‡é‡ï¼Œä¸”ä»·å€¼æ€»å’Œæœ€å¤§ã€‚
è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚

**è¾“å…¥æ ¼å¼**
ç¬¬ä¸€è¡Œä¸¤ä¸ªæ•´æ•°ï¼ŒNï¼ŒV,Mï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç‰©å“ä»¶æ•°ã€èƒŒåŒ…å®¹ç§¯å’ŒèƒŒåŒ…å¯æ‰¿å—çš„æœ€å¤§é‡é‡ã€‚

æ¥ä¸‹æ¥æœ‰ N è¡Œï¼Œæ¯è¡Œä¸‰ä¸ªæ•´æ•° vi,mi,wiï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç¬¬ i ä»¶ç‰©å“çš„ä½“ç§¯ã€é‡é‡å’Œä»·å€¼ã€‚

**è¾“å‡ºæ ¼å¼**
è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å¤§ä»·å€¼ã€‚

```c++
#include<iostream>
using namespace std;
const int N=110;
int n,c,M;
int f[N][N];
int main(){
    cin>>n>>c>>M;
    for(int i=0;i<n;i++){
        int v,m,w;
        cin>>v>>m>>w;
        for(int j=c;j>=v;j--)
          for(int k=M;k>=m;k--)
            f[j][k]=max(f[j][k],f[j-v][k-m]+w);
    }
    cout<<f[c][M]<<endl;
    return 0;
}
```


### åˆ†ç»„èƒŒåŒ…

æœ‰ N ç»„ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ V çš„èƒŒåŒ…ã€‚

æ¯ç»„ç‰©å“æœ‰è‹¥å¹²ä¸ªï¼ŒåŒä¸€ç»„å†…çš„ç‰©å“æœ€å¤šåªèƒ½é€‰ä¸€ä¸ªã€‚
æ¯ä»¶ç‰©å“çš„ä½“ç§¯æ˜¯ vijï¼Œä»·å€¼æ˜¯ wijï¼Œå…¶ä¸­ i æ˜¯ç»„å·ï¼Œj æ˜¯ç»„å†…ç¼–å·ã€‚

æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿ç‰©å“æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚

è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚

**è¾“å…¥æ ¼å¼**
ç¬¬ä¸€è¡Œæœ‰ä¸¤ä¸ªæ•´æ•° Nï¼ŒVï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç‰©å“ç»„æ•°å’ŒèƒŒåŒ…å®¹é‡ã€‚

æ¥ä¸‹æ¥æœ‰ N ç»„æ•°æ®ï¼š

æ¯ç»„æ•°æ®ç¬¬ä¸€è¡Œæœ‰ä¸€ä¸ªæ•´æ•° Siï¼Œè¡¨ç¤ºç¬¬ i ä¸ªç‰©å“ç»„çš„ç‰©å“æ•°é‡ï¼›
æ¯ç»„æ•°æ®æ¥ä¸‹æ¥æœ‰ Si è¡Œï¼Œæ¯è¡Œæœ‰ä¸¤ä¸ªæ•´æ•° vij,wijï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç¬¬ i ä¸ªç‰©å“ç»„çš„ç¬¬ j ä¸ªç‰©å“çš„ä½“ç§¯å’Œä»·å€¼ï¼›
**è¾“å‡ºæ ¼å¼**
è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å¤§ä»·å€¼ã€‚

```c++
#include<iostream>
using namespace std;
const int N=110;
int f[N],s[N];
int v[N][N],w[N][N];
int n,m;
int main(){
   cin>>n>>m;
   for(int i=0;i<n;i++){
     cin>>s[i];
     for(int j=0;j<s[i];j++){
         cin>>v[i][j]>>w[i][j];
     }
   }
   for(int i=0;i<n;i++){
       for(int j=m;j>0;j--){
           for(int k=0;k<s[i];k++){
              if(v[i][k]<=j){
                   f[j]=max(f[j],f[j-v[i][k]]+w[i][k]);
              } 
           }
       }
   }
   cout<<f[m]<<endl;
   return 0;
}
```


### æœ‰ä¾èµ–çš„èƒŒåŒ…é—®é¢˜

æœ‰ N ä¸ªç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ V çš„èƒŒåŒ…ã€‚

ç‰©å“ä¹‹é—´å…·æœ‰ä¾èµ–å…³ç³»ï¼Œä¸”ä¾èµ–å…³ç³»ç»„æˆä¸€æ£µæ ‘çš„å½¢çŠ¶ã€‚å¦‚æœé€‰æ‹©ä¸€ä¸ªç‰©å“ï¼Œåˆ™å¿…é¡»é€‰æ‹©å®ƒçš„çˆ¶èŠ‚ç‚¹ã€‚

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
```
     1
    / \
   2   3
  / \
 4   5
```

å¦‚æœé€‰æ‹©ç‰©å“5ï¼Œåˆ™å¿…é¡»é€‰æ‹©ç‰©å“1å’Œ2ã€‚è¿™æ˜¯å› ä¸º2æ˜¯5çš„çˆ¶èŠ‚ç‚¹ï¼Œ1æ˜¯2çš„çˆ¶èŠ‚ç‚¹ã€‚

æ¯ä»¶ç‰©å“çš„ç¼–å·æ˜¯ iï¼Œä½“ç§¯æ˜¯ viï¼Œä»·å€¼æ˜¯ wiï¼Œä¾èµ–çš„çˆ¶èŠ‚ç‚¹ç¼–å·æ˜¯ piã€‚ç‰©å“çš„ä¸‹æ ‡èŒƒå›´æ˜¯ 1â€¦Nã€‚

æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿ç‰©å“æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚

è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚

è¾“å…¥æ ¼å¼
ç¬¬ä¸€è¡Œæœ‰ä¸¤ä¸ªæ•´æ•° Nï¼ŒVï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç‰©å“ä¸ªæ•°å’ŒèƒŒåŒ…å®¹é‡ã€‚

æ¥ä¸‹æ¥æœ‰ N è¡Œæ•°æ®ï¼Œæ¯è¡Œæ•°æ®è¡¨ç¤ºä¸€ä¸ªç‰©å“ã€‚
ç¬¬ i è¡Œæœ‰ä¸‰ä¸ªæ•´æ•° vi,wi,piï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç‰©å“çš„ä½“ç§¯ã€ä»·å€¼å’Œä¾èµ–çš„ç‰©å“ç¼–å·ã€‚
å¦‚æœ pi=âˆ’1ï¼Œè¡¨ç¤ºæ ¹èŠ‚ç‚¹ã€‚ æ•°æ®ä¿è¯æ‰€æœ‰ç‰©å“æ„æˆä¸€æ£µæ ‘ã€‚

è¾“å‡ºæ ¼å¼
è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å¤§ä»·å€¼ã€‚


```c++
#include<iostream>
#include<cstring>
#include<algorithm>
using namespace std;

const int N = 110;

int n, m;
int h[N], e[N], ne[N], idx;
int v[N], w[N];
int f[N][N];

void add(int x, int y) {
    e[idx] = y, ne[idx] = h[x], h[x] = idx++;
}

void dfs(int x) {
    for (int i = h[x]; i != -1; i = ne[i]) {
        int y = e[i];
        dfs(y);
        for (int j = m - v[x]; j >= 0; j--) {
            for (int k = 0; k <= j; k++) {
                f[x][j] = max(f[x][j], f[x][j - k] + f[y][k]);
            }
        }
    }
    for (int i = m; i >= v[x]; i--) {
        f[x][i] = f[x][i - v[x]] + w[x];
    }
    for (int i = 0; i < v[x]; i++) {
        f[x][i] = 0;
    }
}

int main() {
    memset(h, -1, sizeof h);
    cin >> n >> m;
    int root;
    for (int i = 1; i <= n; i++) {
        int p;
        cin >> v[i] >> w[i] >> p;
        if (p == -1) {
            root = i;
        } else {
            add(p, i);
        }
    }
    dfs(root);
    cout << f[root][m] << endl;
    return 0;
}
```
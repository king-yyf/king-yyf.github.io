---
layout: post
title: codeforces/atcoder é€‰é¢˜
date: 2022-05-15
tags: ç®—æ³•ä¸“é¢˜  
---


===

Index
---
<!-- TOC -->

- [codeforces](#codeforces)
  - [äºŒè¿›åˆ¶å­—ç¬¦ä¸²çš„æœ€å°ä»£ä»·](#äºŒè¿›åˆ¶å­—ç¬¦ä¸²çš„æœ€å°ä»£ä»·)
  - [æœ€é•¿åŒºé—´](#æœ€é•¿åŒºé—´)
  - [åªå‰©ä¸€ä¸ªæ˜Ÿå·çš„æœ€å°æ­¥æ•°](#åªå‰©ä¸€ä¸ªæ˜Ÿå·çš„æœ€å°æ­¥æ•°)
  - [å¯¹è§’çº¿å’Œçš„æœ€å¤§å€¼](#å¯¹è§’çº¿å’Œçš„æœ€å¤§å€¼)
  - [Max GEQ Sum](#åŒºé—´æœ€å¤§å€¼ä¸å°äºåŒºé—´å’Œ)
  - [å­—å…¸åºæœ€å°çš„é”™ä½æ’åˆ—](#å­—å…¸åºæœ€å°çš„é”™ä½æ’åˆ—)
  - [æŒ‰ä½ä¸æ’åˆ—](#æŒ‰ä½ä¸æ’åˆ—)
  - [åˆ’åˆ†ä¸¤ä¸ªé›†åˆ](#åˆ’åˆ†ä¸¤ä¸ªé›†åˆ)
  - [ç›¸ç­‰çš„multiset](#ç›¸ç­‰çš„multiset)
  - [è·å¾—æœ€å¤šå³°å€¼çš„æœ€å°ä»£ä»·](#è·å¾—æœ€å¤šå³°å€¼çš„æœ€å°ä»£ä»·)
  - [çŸ©é˜µè®¡æ•°](#çŸ©é˜µè®¡æ•°)
- [atcoder](#atcoder)
  - [é¥²å–‚æ‰€æœ‰åŠ¨ç‰©çš„æœ€å°ä»£ä»·](#é¥²å–‚æ‰€æœ‰åŠ¨ç‰©çš„æœ€å°ä»£ä»·)
  - [å‰ç¼€é›†åˆæ˜¯å¦ç›¸ç­‰](#å‰ç¼€é›†åˆæ˜¯å¦ç›¸ç­‰)
  - [æœ€å€¼ä¸ºxyçš„æ•°å¯¹æ•°ç›®](#æœ€å€¼ä¸ºxyçš„æ•°å¯¹æ•°ç›®)
  - [æœ€çŸ­è·¯å¾„æ ‘](#æœ€çŸ­è·¯å¾„æ ‘)
  - [è‚¡ç¥¨äº¤æ˜“(åæ‚”è´ªå¿ƒ)](#è‚¡ç¥¨äº¤æ˜“)
  - [æ»¡è¶³å…ˆåºéå†åºåˆ—çš„æ•°é‡](#æ»¡è¶³å…ˆåºéå†åºåˆ—çš„æ•°é‡)
  - [æœ€å¤šå¥–é‡‘æ•°](#æœ€å¤šå¥–é‡‘æ•°)
  - [æ¯æ¬¡æ“ä½œåçš„å€¼](#æ¯æ¬¡æ“ä½œåçš„å€¼)
  - [å‡å€¼ä¸ºæ•´æ•°çš„å­åºåˆ—æ•°é‡](#å‡å€¼ä¸ºæ•´æ•°çš„å­åºåˆ—æ•°é‡)
  - [dp contest](#dpcontest)
    - [æ­£é¢å¤šäºåé¢çš„æ¦‚ç‡](#æ­£é¢å¤šäºåé¢çš„æ¦‚ç‡)
    - [æœ‰å‘å›¾ä¸­æœ€é•¿è·¯å¾„](#æœ‰å‘å›¾ä¸­æœ€é•¿è·¯å¾„)
    - [åƒå®Œæ‰€æœ‰å¯¿å¸çš„æœŸæœ›æ“ä½œæ¬¡æ•°](#åƒå®Œæ‰€æœ‰å¯¿å¸çš„æœŸæœ›æ“ä½œæ¬¡æ•°)
    - [çŸ³å­æ¸¸æˆ](#çŸ³å­æ¸¸æˆ)
    - [å…ˆæ‰‹åæ‰‹å¾—åˆ†å·®](#å…ˆæ‰‹åæ‰‹å¾—åˆ†å·®)
    - [åˆ†ç³–æœæ–¹æ¡ˆæ•°](#åˆ†ç³–æœæ–¹æ¡ˆæ•°)

   
<!-- /TOC -->

## codeforces

### äºŒè¿›åˆ¶å­—ç¬¦ä¸²çš„æœ€å°ä»£ä»·

[ecr128c div2](https://codeforces.com/contest/1680/problem/C)

é¢˜ç›®ï¼šå­—ç¬¦ä¸²såªåŒ…å«å­—ç¬¦ '0'å’Œ'1'ï¼Œä½ å¯ä»¥ä»sçš„å¼€å§‹å’Œç»“æŸåˆ é™¤ä»»æ„æ•°ç›®çš„å­—ç¬¦(åŒ…æ‹¬0ä¸ªæˆ–è€…å…¨éƒ¨)ï¼Œåˆ é™¤åçš„å­—ç¬¦ä¸²ä»£ä»·æ˜¯ä¸‹é¢ä¸¤ä¸ªå€¼çš„æœ€å¤§å€¼

+ å‰©ä½™å­—ç¬¦ä¸²ä¸­0çš„æ•°ç›®
+ åˆ æ‰å­—ç¬¦ä¸²ä¸­1çš„æ•°ç›®

æ±‚åˆ é™¤åå­—ç¬¦ä¸²sçš„æœ€å°ä»£ä»·ã€‚

+ 1 <= s.length <= 2e5

**æ–¹æ³•1:äºŒåˆ†**

è®¾æ€»å…±æœ‰mä¸ª1ï¼Œå…¶å‡ºç°ä½ç½®åˆ†åˆ«åœ¨p[0],,,p[m-1], åˆ™ç­”æ¡ˆä¸è¶…è¿‡mï¼Œå¯¹ç­”æ¡ˆè¿›è¡ŒäºŒåˆ†ï¼Œè®¾å½“å‰æ£€æµ‹çš„ç­”æ¡ˆä¸ºmd,åˆ™æˆ‘ä»¬æœ€å¤šèƒ½åˆ é™¤mdä¸ª1ï¼Œä¸”å½“æˆ‘ä»¬åˆ é™¤mdä¸ª1æ—¶ï¼Œèƒ½ç•™ä¸‹æœ€å°‘çš„0ï¼Œå› ä¸ºä»ä¸¤ç«¯åˆ é™¤1ä¸å›å¢åŠ å‰©ä¸‹çš„0çš„æ•°ç›®ã€‚ä¾æ¬¡æšä¸¾ï¼Œå‰é¢åˆ é™¤iä¸ª1ï¼Œåé¢åˆ é™¤md-iä¸ª1æ—¶ï¼Œä¸­é—´ç•™ä¸‹çš„0æ˜¯å¦å°äºç­‰äºmdï¼Œåˆ¤æ–­mdç­”æ¡ˆæˆä¸æˆç«‹å³å¯ã€‚

```c++
int minStringCost(string& s) {
    int n = s.size();
    vector<int> s1(n + 1), p;
    for (int i = 0; i < n; ++i) {
        s1[i + 1] = s1[i] + (s[i] == '0');
        if (s[i] == '1') p.push_back(i);
    }
    int m = p.size(), l = 0, r = m, ans = m;
    while (l < r) {
        int md = (l + r) / 2;
        bool ok = 0;
        for (int i = 0; i <= md; ++i) {
            int l1 = p[i], r1 = p[m - 1 - md + i];
            if (s1[r1 + 1] - s1[l1] <= md) {
                ok = 1;
            } 
        }
        if (ok) r = md;
        else l = md + 1;
    }
    return l;
}
```

**æ–¹æ³•2ï¼šæ»‘åŠ¨çª—å£**

```c++
int minStringCost1(string& s) {
    int n = s.size(), x = 0, y = 0, ans = n;
    for (int i = 0; i < n; ++i) {
        if (s[i] == '0') x++;
        else y++;
    }
    int x1 = 0, y1 = y, j = 0;
    for (int i = 0; i < n; ++i) {
        while (j < n && x1 < y1) {
            if (s[j] == '0') x1++;
            else y1--;
            j++;
        }
        ans = min(ans, max(x1, y1));
        if (s[i] == '0') x1--;
        else y1++;
    }
    return ans;
}
```

**æ–¹æ³•3:åŠ¨æ€è§„åˆ’**

```c++
int minStringCost(string& s) {
    int n = s.size();
    vector<int> p(n + 1);
    for (int i = 0; i < n; ++i) {
        p[i + 1] = p[i] + (s[i] == '1');
    }
    if (p[n] == n || p[n] == 0) return 0;
    int res = min(p[n], n - p[n]);
    for (int i = 1; i <= n; ++i) {
        if (i >= p[n]) res = min(res, (i - p[i]) - (i - p[n] - p[i - p[n]]));
        else res = min(res, p[n] - p[i]);
    }
    return res;
}
```

### æœ€é•¿åŒºé—´

[cr790F div4](https://codeforces.com/contest/1676/problem/F)

é¢˜æ„ï¼šæ•°ç»„aï¼Œé•¿åº¦ä¸ºnï¼Œç»™å®škï¼Œæ‰¾å‡ºä»»æ„ä¸¤ä¸ªl,r,æ»¡è¶³

+ å¯¹ä»»æ„ l <= x <= r, x åœ¨æ•°ç»„ä¸­è‡³å°‘å‡ºç°kæ¬¡ã€‚
+ r - l å°½å¯èƒ½å¤§
+ 1 <= n <= 2e5, 1 <= k <= n, 1 <= ai <= 1e9

```c++
vector<int> maxRange(vector<int>& a, int k) {
    int n = a.size();
    map<int, int> mp;
    for(auto& x : a) mp[x]++;
    mp[INT_MAX] = 0;
    int ansl = -1, ansr = -2, l = -1, r = -2;
    for (auto &[x, y] : mp) {
        if (y < k || x != r + 1) {
            if (r - l >= ansr - ansl) {
                ansl = l, ansr = r;
            }
            if (y >= k) l = r = x;
        } else r = x;
    }
    if (ansl > 0) return {ansl, ansr};
    return {};
}
```

### åªå‰©ä¸€ä¸ªæ˜Ÿå·çš„æœ€å°æ­¥æ•°

[ecr128E, div2](https://codeforces.com/contest/1680/problem/E)

é¢˜æ„ï¼šæœ‰ä¸€ä¸ª`2*n`çš„æ–¹æ ¼, åŒ…æ‹¬ æ˜Ÿå· `'*'`å’Œç©ºç™½ `.`ï¼Œä¿è¯è‡³å°‘æœ‰1ä¸ªæ˜Ÿå·ã€‚

æ¯ä¸€æ­¥æ˜Ÿå·å¯ä»¥ç§»åŠ¨åˆ°ç›¸é‚»çš„æ ¼å­ï¼Œå¦‚æœç§»åŠ¨åçš„æ–°æ ¼å­æ˜¯`*`ï¼Œåˆ™è¯¥æ ¼å­çš„`*`è¢«æ¶ˆç­ï¼Œ`*`ä¸èƒ½èµ°å‡ºæ–¹æ ¼ã€‚

æ±‚ä½¿å¾—æ–¹æ ¼ä¸­æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª`*`çš„æœ€å°‘ç§»åŠ¨æ­¥æ•°ã€‚

+ 1 <= n <= 2e5

**æç¤º**

+ æœ€å‰é¢ä¸¤åˆ—éƒ½æ˜¯ç©ºç™½çš„å’Œæœ€åé¢ä¸¤åˆ—éƒ½æ˜¯ç©ºç™½çš„å¯¹ç­”æ¡ˆæ²¡æœ‰è´¡çŒ®ï¼Œå¯ä»¥åˆ å»ã€‚
+ å‡è®¾æœ€åå‰©çš„`*`åœ¨ç¬¬jåˆ—ï¼Œé‚£ä¹ˆå°äºjåˆ—çš„`*`åªä¼šå¾€å³èµ°ï¼Œå¤§äºjåˆ—çš„`*`åªä¼šå¾€å·¦èµ°ã€‚
+ æœ€ä¼˜è§£ä¸­ï¼Œå½“å‰åˆ—åªä¼šä¿ç•™ä¸€ä¸ª`*`ï¼Œå› ä¸ºå¦‚æœæœ‰ä¸¤ä¸ª`*`ï¼Œé‚£ä¹ˆæ¶ˆç­æ‰ä¸€ä¸ª`*`ï¼Œåªç•™ä¸€ä¸ª`*`å‘å³èµ°ä¼šæ›´ä¼˜ã€‚

dp[i][0]: æœ€åå¤„ç†çš„ç¬¬iåˆ—ï¼Œä¸”`*`åœ¨ç¬¬0è¡Œã€‚
dp[i][0]: æœ€åå¤„ç†çš„ç¬¬iåˆ—ï¼Œä¸”`*`åœ¨ç¬¬1è¡Œã€‚

ç­”æ¡ˆä¸º `min(dp[n - 1][0], dp[n - 1][1])`

```c++
int minMoveCost(vector<string>& s) {
    for (int i = 0; i < 2; ++i) {
        while (s[0].back() == '.' && s[1].back() == '.') {
            s[0].pop_back();s[1].pop_back();
        }
        reverse(s[0].begin(), s[0].end());
        reverse(s[1].begin(), s[1].end());
    }
    int n = s[0].size();
    vector<vector<int>> dp(n, vector<int>(2, 1e9));
    dp[0][0] = (s[1][0] == '*');
    dp[0][1] = (s[0][0] == '*');
    for (int i = 0; i + 1 < n; ++i) {
        dp[i + 1][0] = min(dp[i + 1][0], dp[i][0] + 1 + (s[1][i + 1] == '*'));
        dp[i + 1][0] = min(dp[i + 1][0], dp[i][1] + 2);
        dp[i + 1][1] = min(dp[i + 1][1], dp[i][1] + 1 + (s[0][i + 1] == '*'));
        dp[i + 1][1] = min(dp[i + 1][1], dp[i][0] + 2);
    }
    return min(dp[n - 1][0], dp[n - 1][1]);
}
```

### å¯¹è§’çº¿å’Œçš„æœ€å¤§å€¼

[cr790D div4](https://codeforces.com/contest/1676/problem/D)

æœ‰ä¸€ä¸ª n * m çš„æ•´æ•°æ•°ç»„ï¼Œåœ¨ä»»æ„ä½ç½®æ”¾ä¸€ä¸ªæ£‹å­ï¼Œå…¶å¾—åˆ†ä¸ºè¿‡è¯¥ä½ç½®çš„ä¸¤æ¡æ–œå¯¹è§’çº¿ä¹‹å’Œï¼Œæ±‚å¾—åˆ†çš„æœ€å¤§å€¼ã€‚

+ 0 <= ai <= 1e6
+ 1 <= n, m <= 200


**æ–¹æ³•1:å¯¹è§’çº¿å‰ç¼€å’Œ**

```c++
void solve() {
    int n, m;
    std::cin >> n >> m;
    
    std::vector a(n, std::vector<int>(m)), f(a), g(a);
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < m; j++) {
            std::cin >> a[i][j];
            f[i][j] = g[i][j] = a[i][j];
            if (i > 0 && j > 0) {
                f[i][j] += f[i - 1][j - 1];
            }
            if (i > 0 && j + 1 < m) {
                g[i][j] += g[i - 1][j + 1];
            }
        }
    }
    for (int i = n - 1; i > 0; i--) {
        for (int j = 0; j < m; j++) {
            if (j > 0) {
                f[i - 1][j - 1] = f[i][j];
            }
            if (j + 1 < m) {
                g[i - 1][j + 1] = g[i][j];
            }
        }
    }
    int ans = 0;
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < m; j++) {
            ans = std::max(ans, f[i][j] + g[i][j] - a[i][j]);
        }
    }
    std::cout << ans << "\n";
}
```

**æ–¹æ³•2:å“ˆå¸Œ**

ç”±äºå¤„åœ¨åŒä¸€æ–œå¯¹è§’çº¿ä¸Šçš„è¦ä¹ˆx+yç›¸ç­‰ï¼Œè¦ä¹ˆx-yç›¸ç­‰ï¼Œæ‰€ä»¥å¯ä»¥æŒ‰ç…§x+y,x-yçš„å€¼ç›´æ¥ç»Ÿè®¡ã€‚

å¯¹è§’çº¿å‰ç¼€å’Œè®¡ç®—ä»£ç 

```c++
for(int i=1;i<=n;i++){
    for(int j=1;j<=n;j++){
        x[i][j]=x[i-1][j-1]+a[i][j];//è¿›è¡Œå‰ç¼€å’Œè®¡æ•°ï¼Œx[][]è¡¨ç¤ºä¸»å¯¹è§’çº¿
        y[i][j]=y[i-1][j+1]+a[i][j];//y[][]è¡¨ç¤ºå‰¯å¯¹è§’çº¿
    }
}
```

```c++
int maxDiagSum(vector<vector<int>>& a) {
    int n = a.size(), m = a[0].size(), ans = 0;
    map<int,long long> m1, m2;
    for (int i = 0; i < n; ++i) {
        for (int j = 0; j < m; ++j) 
            m1[i + j] += a[i][j], m2[i - j] += a[i][j];
    }
    for (int i = 0; i < n; ++i) 
        for (int j = 0; j < m; ++j) 
            ans = max(ans + 0LL, m1[i + j] + m2[i - j] - a[i][j]);
    return ans;
}
```

### åŒºé—´æœ€å¤§å€¼ä¸å°äºåŒºé—´å’Œ

æ•°ç»„aï¼Œé•¿åº¦ä¸ºnï¼Œå¦‚ä¸‹ä¸ç­‰å¼æ˜¯å¦æˆç«‹ï¼Ÿ
    `max(a[i],...,a[j]) >= a[i] + ... + a[j]`
å¯¹ä»»æ„çš„ä¸‹æ ‡å¯¹i,jæ»¡è¶³ `1<==i<=j<=n`ã€‚

+ 1 <= n <= 2e5
+ -1e9 <= a[i] <= 1e9

**åˆ†æ**

å¯ä»¥ä½¿ç”¨å•è°ƒæ ˆæ±‚å‡ºä»¥iä¸ºæœ€å¤§å€¼çš„åŒºé—´ï¼Œè®¾ä¸º l, l+1, ...,i, i+1, ... r.

åˆ™åŒºé—´å¼€å§‹åœ¨[l,i]ï¼Œç»“æŸåœ¨[i,r]çš„æ‰€æœ‰åŒºé—´å’Œéƒ½ä¸å¤§äºa[i]ã€‚
è®¾å·¦è¾¹åŒºé—´å’Œ(ä¸åŒ…æ‹¬a[i])ä¸ºxï¼Œå³è¾¹åŒºé—´å’Œ(ä¸åŒ…æ‹¬a[i])ä¸ºy

åˆ™ x+y+a[i] <= a[i], å³ x + y <= 0, 
å¯¹äºä¸æ»¡è¶³çš„ä¸‹æ ‡å¯¹ x å’Œy è‡³å°‘æœ‰ä¸€ä¸ªå¤§äº0ï¼Œ 
è®¾æ•°ç»„açš„å‰ç¼€å’Œæ•°ç»„ä¸º pref, åç¼€å’Œä¸ºsuf.
åˆ™ä¸æ»¡è¶³æ¡ä»¶æ—¶ max(suf[l], ..., suf[i-1]) > suf[i]
æˆ–è€… max(pref[r+1], ..., pref[i+2]) > pref[i+1]
 
```c++
#include <bits/stdc++.h>
using namespace std;

long long op(long long x, long long y) {return max(x, y);}
template <class T, T (*op)(T, T)>
class ST {
 public:
  int n;
  vector<vector<T>> mat;
 
  ST(const vector<T>& a) {
    n = static_cast<int>(a.size());
    int max_log = 32 - __builtin_clz(n);
    mat.resize(max_log);
    mat[0] = a;
    for (int j = 1; j < max_log; j++) {
      mat[j].resize(n - (1 << j) + 1);
      for (int i = 0; i <= n - (1 << j); i++) {
        mat[j][i] = op(mat[j - 1][i], mat[j - 1][i + (1 << (j - 1))]);
      }
    }
  }
 
  T get(int from, int to) const {
    assert(0 <= from && from <= to && to <= n - 1);
    int lg = 32 - __builtin_clz(to - from + 1) - 1;
    return op(mat[lg][from], mat[lg][to - (1 << lg) + 1]);
  }
};

int n,m,x,y,k,q;
void solve(){
    cin>>n;
    vector<int> a(n);
    for(auto&x: a) cin>>x;
    
    vector<long long> pref(n + 1), suf(n + 1), left(n, -1), right(n, n);
    for (int i = 0; i < n; ++i) pref[i + 1] = pref[i] + a[i];
    for (int i = n - 1; i >= 0; --i) suf[i] = suf[i + 1] + a[i];
    stack<int> sk;
    for (int i = 0; i < n; ++i) {
        while(!sk.empty() && a[sk.top()] < a[i]) {
            right[sk.top()] = i;
            sk.pop();
        }
        sk.push(i);
    }
    sk = stack<int>();
    for (int i = n - 1; i >= 0; --i) {
        while (!sk.empty() && a[sk.top()] <= a[i]) {
            left[sk.top()] = i;
            sk.pop();
        }
        sk.push(i);
    }
    ST<long long,op> st1(pref), st2(suf);
    for(int i=0;i<n;++i){
        int l=left[i]+1,r=right[i]-1;
        long long x=-1e18,y=-1e18;
        if(i+2<=r+1) y=st1.get(i+2,r+1);
        if(l<=i-1) x=st2.get(l,i-1);
        if(pref[i+1]<y||suf[i]<x){
            cout<<"NO\n";
            return;
        }
    }
    cout<<"YES\n";
}
int main(){
    ios::sync_with_stdio(0); cin.tie(0); cout.tie(0);
    cout<<fixed<<setprecision(20);
    int T=1;
    cin >> T;
    for (int case_i = 1; case_i <= T; ++case_i) {
        solve();
    }
    return 0;
}
```

### å­—å…¸åºæœ€å°çš„é”™ä½æ’åˆ—

[cr798 1689B](https://codeforces.com/contest/1689/problem/B)

ç»™ä¸€ä¸ª1-nçš„æ’åˆ— p1,p2,...,pnï¼Œæ„é€ ä¸€ä¸ªæ–°çš„æ’åˆ— q1,q2,...,qn, ä½¿å¾— 
p1!=q1, p2!=q2, ..., pn!=qn,ä¸”qçš„å­—å…¸åºæœ€å°ã€‚å¦‚æœæ— è§£ï¼Œè¿”å›ç©ºã€‚

+ 1 <= n <= 1000
+ è¿›é˜¶ï¼Œå¦‚æœ n <= 3e5, æ€ä¹ˆæ±‚ï¼Ÿ

**åˆ†æ**

+ å¦‚æœn=1ï¼Œæ— è§£
+ è´ªå¿ƒé€‰æ‹©ï¼Œå¯¹äºå‰n-2ä¸ªæ•°å­—ï¼Œæ¯æ¬¡é€‰æ‹©å‰©ä½™æ²¡æœ‰è¢«ä½¿ç”¨çš„ä¸”ä¸ç­‰äºå½“å‰ä½ç½®å€¼çš„æœ€å°å€¼.
+ å¯¹äºåä¸¤ä¸ªå…ƒç´ ï¼Œè®¾å‰©ä½™çš„ä¸¤ä¸ªæ²¡æœ‰è¢«é€‰æ‹©çš„æ•°å­—ä»å°åˆ°å¤§ä¸ºa,bï¼Œå¦‚æœa,bæ»¡è¶³ï¼Œåˆ™ä¸ºa,bï¼Œå¦åˆ™b,aä¸€å®šæ»¡è¶³æ¡ä»¶ã€‚

```c++
/*
a: 0-n-1æ’åˆ—
return : 0 - n - 1æ’åˆ—
*/
vector<int> minLexicographicallyPerm(vector<int> &nums) {
    int n = nums.size();
    if (n == 1) return {};
    vector<int> s(n), c(n);
    for (int i = 0; i < n - 2; ++i) {
        for (int j = 0; j < n; ++j) {
            if (!s[j] && nums[i] != j) {
                s[j] = 1, c[i] = j;
                break;

            }
        }
    }
    int a = -1, b = -1; 
    for (int i =  0; i < n; ++i) if (!s[i]) {
        if (a == -1) a = i;
        else b = i;
    }
    if (a == nums[n - 2] || b  == nums[n - 1]) swap(a, b);
    c[n - 2] = a, c[n - 1] = b;
    return c;
}
```

**è¿›é˜¶**

O(n) ç®—æ³•

```c++
vector<int> minLexicographicallyPerm1(vector<int> &a) {
    int n = a.size();
    if (n == 1) return {};
    vector<int> b(n);
    for (int i = 0; i < n; ++i) b[i] = i;

    for (int i = 0; i < n - 1; ++i) if (a[i] == b[i])
        swap(b[i], b[i + 1]);
    if (a[n - 1] == b[n - 1]) swap(b[n - 2], b[n - 1]);
    return b;
}
```

### æŒ‰ä½ä¸æ’åˆ—

[cr455 div2 f](https://codeforces.com/contest/909/problem/F)

å¯¹äºæ•´æ•°nï¼Œæ‰¾ä¸¤ä¸ªæ’åˆ—
1. æ’åˆ—p, å¯¹äºä»»æ„ i = 1, 2, ..., nï¼Œp[i]!=i ä¸” p[i] & i == 0
2. æ’åˆ—q, å¯¹äºä»»æ„ i = 1, 2, ..., nï¼Œq[i]!=i ä¸” q[i] & i != 0

+ 1 <= n <= 1e5


```c++
void solvep(int n){ // 0
    if(n % 2 == 1){
        cout << "NO" << endl; return;
    }
    int ans[n+1];
    int cur = n;
    while(cur){
        int f = 1;
        while(f <= cur) f *= 2;
        f--;
        for(int i = cur; i > f-cur; i--){
            ans[i] = f-i;
            ans[f-i] = i;
        }
        cur = f-cur - 1;
    }
    cout << "YES" << endl;
    for(int i = 1; i <= n; i++){
        cout << ans[i] << " ";
    }
    cout << endl;
    return;
}
void solveq(int n){ // nonzero
    if(n <= 5 || __builtin_popcount(n) == 1){
        cout << "NO" << endl; return;
    }
    int ans[n+1];
    ans[2] = 6; ans[6] = 2;
    ans[1] = 3; ans[3] = 1;
    vector<int> g[30];
    for(int j = 1; j <= n; j++){
        if(6 % j == 0) continue;
        for(int r = 0; r < 25; r++){
            if(j >= (1<<r) && j < (1 << (r+1))){
                g[r].push_back(j);
            }
        }
    }
    for(int r = 0; r < 25; r++){
        for(int i = 0; i < g[r].size(); i++){
            ans[g[r][i]] = g[r][(i+1) % g[r].size()];
        }
    }
    cout << "YES" << endl;
    for(int i = 1; i <= n; i++){
        cout << ans[i] << " ";
    }
    cout << endl;
    return;    
}
```

### åˆ’åˆ†ä¸¤ä¸ªé›†åˆ

[cr 805 div3 E](https://codeforces.com/contest/1702/problem/E)

nä¸ªå¤šç±³è¯ºéª¨ç‰Œï¼Œ(næ˜¯å¶æ•°),æ¯ä¸ªå¤šç±³è¯ºéª¨ç‰Œä¸Šå†™ä¸¤ä¸ª1-nçš„æ•°ï¼Œé—®èƒ½å¦å°†è¿™äº›å¤šç±³è¯ºéª¨ç‰Œåˆ†æˆä¸¤ä»½ï¼Œä½¿å¾—æ¯ä¸€ä»½ä¸­éƒ½æ²¡æœ‰é‡å¤çš„æ•°å­—ã€‚

+ 2 <= n <= 2e5

**åˆ†æ**

æ˜¾ç„¶æ¯ä»½1-nä¸­æ¯ä¸ªæ•°æ°å¥½å‡ºç°ä¸€æ¬¡

1. **å¹¶æŸ¥é›†**

å¯¹äºæ¯ä¸€å¼ å¤šç±³è¯ºéª¨ç‰Œï¼Œå°±å°†æ­£é¢ä¸åé¢çš„æ•°åˆå¹¶ï¼Œè¿™è¡¨ç¤ºæˆ‘ä»¬å–äº†æ­£é¢çš„æ•°å°±ä¸€å®šä¼šå–åé¢çš„æ•°ã€‚**æœ€åå¦‚æœå­˜åœ¨ä¸€ä¸ªè¿é€šå—ä¸­çš„ç‚¹æ•°æ˜¯å¥‡æ•°ï¼Œè¯´æ˜è‡³å°‘æœ‰ä¸€ä¸ªæ•°è¢«é‡å¤é€‰å–äº†ã€‚**

```c++
struct DSU {
  ...
};

// a[i]: 0-n-1, b[i]: 0-n-1
bool canDivide2set(vector<int> &a, vector<int> &b) {
    int n = a.size();
    vector<int> cnt(n);
    DSU dsu(n);
    for (int i = 0; i < n; ++i) {
        cnt[a[i]]++, cnt[b[i]]++;
        if (a[i] == b[i]) return 0;
        dsu.merge(a[i], b[i]);
    }
    for (int i = 0; i < n; ++i) {
        if (dsu.size(i) % 2 == 1 || cnt[i] > 2) return 0;
    }
    return 1;
}
```

tourist å¤§ä½¬çš„å¹¶æŸ¥é›†å†™æ³•ï¼š

```c++
// a[i]: 0-n-1, b[i]: 0-n-1
bool canDivide2set(vector<int> &a, vector<int> &b) {
    int n = a.size();
    vector<int> c(n);
    DSU dsu(n * 2);
    for (int i = 0; i < n; ++i) {
        c[a[i]]++, c[b[i]]++;
        dsu.merge(a[i], b[i] + n);
        dsu.merge(a[i] + n, b[i]);
    }
    for (int i = 0; i < n; ++i) {
        if (c[i] > 2 || dsu.same(i, i + n)) return 0;
    }
    return 1;
}
```

2. äºŒåˆ†å›¾ dfs

å°†1-nçœ‹æˆnä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªå¤šç±³è¯ºæ˜¯ä¸€æ¡è¾¹ï¼Œå› ä¸º1-næ¯ä¸ªæ•°å‡ºç°2æ¬¡ï¼Œå›¾ä¸­æœ‰å¤šä¸ªç¯ï¼Œç¯é•¿å¿…é¡»æ˜¯å¶æ•°ã€‚

```c++
// a[i]: 0-n-1, b[i]: 0-n-1
bool canDivide2set(vector<int> &a, vector<int> &b) {
    int n = a.size();
    vector<vector<int>> g(n);
    vector<int> vis(n);
    bool ok = 0;
    for (int i = 0; i < n; ++i) {
        g[a[i]].push_back(b[i]);
        g[b[i]].push_back(a[i]);
        if (a[i] == b[i] || g[a[i]].size() > 2 || g[b[i]].size() > 2) return 0;
    }

    function<int(int)> dfs = [&](int u) {
        vis[u] = 1;
        for (auto &v: g[u]) {
            if (!vis[v]) return dfs(v) + 1;
        }
        return 1;
    };

    for (int i = 0; i < n; ++i) {
        if (!vis[i]) {
            if (dfs(i) % 2) return 0;
        }
    }
    return 1;
}
```

### ç›¸ç­‰çš„multiset

[cr805 div3F](https://codeforces.com/contest/1702/problem/F)
[abc 254 Ex](https://atcoder.jp/contests/abc254/tasks/abc254_h)

ä¸¤ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„a,b, ä¸€æ¬¡æ“ä½œï¼Œä½ å¯ä»¥bä¸­ä¸€ä¸ªå…ƒç´ ä¹˜ä»¥2æˆ–é™¤ä»¥2ï¼Œå¯ä»¥åšä»»æ„æ¬¡æ“ä½œï¼Œèƒ½å¦ä½¿å¾—aï¼Œbç›¸ç­‰ã€‚


**åˆ†æ**

é¦–å…ˆå¦‚æœaä¸­æŸä¸ªå…ƒç´ æ˜¯å¶æ•°ï¼Œå¯ä»¥ä¸€ç›´å¯¹å…¶åšé™¤ä»¥2æ“ä½œï¼Œç›´åˆ°aä¸­ä¸ºå¥‡æ•°ï¼Œå¦‚æœbå¯ä»¥å’Œaä¸­è¯¥å¥‡æ•°ç›¸ç­‰ï¼Œåˆ™å¯ä»¥é€šè¿‡ä¹˜ä»¥2æ“ä½œï¼Œä½¿å…¶å’ŒåŸå§‹æ•°ç›¸ç­‰ã€‚è¿™æ ·åœ¨bä¸­åªéœ€åšé™¤ä»¥2æ“ä½œã€‚

ç„¶åä»å¤§åˆ°å°ï¼Œå¯¹a,bè¿›è¡Œæ’åºï¼Œæ¯ä¸€æ¬¡æ¯”è¾ƒaã€bä¸­ç›¸åº”å…ƒç´ ï¼Œå¦‚æœç›¸ç­‰ï¼Œåˆ™å°†ä¸¤ä¸ªå…ƒç´ éƒ½åˆ æ‰ï¼Œå¦‚æœä¸ç­‰ï¼Œå¦‚æœbä¸­å…ƒç´ å·²ç»ä¸º1ï¼Œåˆ™ä¸å¯èƒ½å˜ä¸ºa (åé¢å…ƒç´ ä¹Ÿå…¨å˜ä¸º1)ï¼Œå¦åˆ™åˆ æ‰bä¸­å…ƒç´ ï¼Œå‡å¦‚ è¯¥å…ƒç´ çš„ä¸€åŠï¼Œæœ€ååˆ¤æ–­bæ˜¯å¦ä¸ºç©ºã€‚

+ 1 <= n <= 2e5
+ 1 <= a[i], b[i] <= 1e9

```c++
bool isEquateMultisets(vector<int> &a, vector<int> &b) {
    priority_queue<int> q1, q2;
    for(auto &x: a) {
        while (x % 2 == 0) x /= 2;
        q1.push(x);
    }
    for (auto &x: b) {
        q2.push(x);
    }
    while (!q2.empty()) {
        if (q1.top() == q2.top()) {
            q1.pop(), q2.pop();
        } else {
            if (q2.top() == 1) return 0;
            q2.push(q2.top() / 2);
            q2.pop();
        }
    }
    return q2.empty();
}
```

**æ–¹æ³•2**

å°†æ“ä½œçœ‹ä½œæ˜¯äºŒè¿›åˆ¶è¿ç®—

å°†æ¯ä¸€ä¸ªæ•°çœ‹ä½œæ˜¯äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå…¶ä¸­

+ é™¤ä»¥2æ“ä½œï¼Œåˆ é™¤Bä¸­stringçš„æœ€åä¸€ä¸ªå­—ç¬¦
+ ä¹˜ä»¥2æ“ä½œï¼Œåˆ é™¤Aä¸­stringçš„ç»“æŸä¸º'0'çš„å­—ç¬¦ ï¼ˆå’ŒBä¸­å…ƒç´ é™¤ä»¥2ç­‰ä»·ï¼‰

**ä½¿ç”¨ Trie**

ä¸ºå­—ç¬¦ä¸²A,Bæ„é€ ä¸€ä¸ªTrieï¼Œæ¯ä¸ªæ“ä½œå¯ä»¥è®¤ä¸ºå°†ä¸€ä¸ªå­—ç¬¦ä¸²å˜ä¸ºå…¶çˆ¶èŠ‚ç‚¹ï¼Œåœ¨trieæ ‘ä¸­ï¼Œä»å¶èŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹ï¼Œè¿›è¡Œé€ä¸ªåŒ¹é…ã€‚


```c++
bool isEquateMultisets(vector<int> &a, vector<int> &b) {
    vector<vector<int>> trie(1, vector<int>(2, -1));
    vector<int> val(1, 0);
    for (int i = 0; i < 2 * n; ++i) {
        int x = (i < n ? b[i] : a[i - n]);
        int sign  = (i < n ? 1 : -1);
        while (x % 2 == 0) x /= 2;
        int bit = 30;
        while (!(x & (1 << bit))) bit -= 1;
        int t = 0;
        for (int j = bit; j >= 0; --j) {
            int d = (x >> j) & 1;
            if (trie[t][d] == -1) {
                trie[t][d] = (int) trie.size();
                trie.emplace_back(2, -1);
                val.push_back(0);
            }
            t = trie[t][d];
            val[t] += sign;
            if (val[t] < 0) return 0;
        }
    }
    return 1;
}
```

### è·å¾—æœ€å¤šå³°å€¼çš„æœ€å°ä»£ä»·

[cf 809c dic2](https://codeforces.com/contest/1706/problem/C)


é•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œä¸€ä¸ªå³°å€¼æŒ‡ a[i] > a[i-1] ä¸” a[i] > a[i+1] (a[i]ä¸èƒ½ä¸ºç¬¬ä¸€ä¸ªæˆ–æœ€åä¸€ä¸ªæ•°), å¯ä»¥ç»™æ¯ä¸ªå€¼åŠ ä¸Šä»»æ„æ•°ï¼Œä»£ä»·ä¸ºæ‰€åŠ æ•°çš„å€¼ï¼Œæ±‚ä½¿å¾—æ•°ç»„å³°å€¼æœ€å¤šçš„æœ€å°ä»£ä»·ã€‚


+ 3 <= n <= 2e5
+ 1 <= a[i] <= 1e9


```c++
long long minCostMaxMountainValue(vector<int> &a) {
    int n = a.size();

    auto get = [&](int x) {
        long long  t = max(a[x - 1], a[x + 1]) + 1;
        return max(t - a[x], 0ll);
    };
    long long tot = 0, ans = 0;
    for (int i = 1; i < n - 1; i += 2) {
        tot += get(i);
    }
    ans = tot;
    if (n % 2 == 0) {
        for (int i = n - 2; i > 0; i -= 2) {
            tot -= get(i - 1);
            tot += get(i);
            ans = min(ans, tot);
        }
    }
    return ans;
}
```

### çŸ©é˜µè®¡æ•°

[cr 817 div4 E](https://codeforces.com/contest/1722/problem/E)

æœ‰nä¸ªçŸ©å½¢ï¼Œç¬¬iä¸ªé«˜hi,å®½wi.
ç»™å®šqä¸ªè¯¢é—®ï¼Œhs,ws,hb,wb;

æ±‚æ»¡è¶³ `hs < hi < hb` ä¸” `ws < wi < wb` çš„çŸ©å½¢é¢ç§¯ä¹‹å’Œï¼ŒçŸ©å½¢ä¸èƒ½æ—‹è½¬ã€‚

+ 1 <= hi, wi <= 1000
+ 1 â‰¤ â„ğ‘  < â„ğ‘ , ğ‘¤ğ‘  < ğ‘¤ğ‘ â‰¤ 1000
+ 1 <= n, q <= 1e5

**åˆ†æ**

äºŒç»´å‰ç¼€å’Œï¼Œå®šä¹‰äºŒç»´æ•°ç»„ a[1001][1001], å¦‚æœæœ‰ä¸ªé•¿ä¸ºh,å®½ä¸ºwçš„çŸ©å½¢ï¼Œ åˆ™ a[h][w] += h * w;
sä¸ºaçš„å‰ç¼€å’Œï¼Œåˆ™å¯¹äºæŸ¥è¯¢hs,ws,hb,wbï¼Œä»hs+1,ws+1åˆ° hb-1ï¼Œwb-1ä¹‹é—´çš„çŸ©å½¢å’Œå³ä¸ºç­”æ¡ˆã€‚

```c++
#include<bits/stdc++.h>
using namespace std;
int main(){
    int n, q, h, w, hs, ws, hb, wb, t;
    cin >> t;
    while (t--) {
        cin >> n >> q;
        vector s(1001, vector<long long>(1001));
        for (int i = 0; i < n; ++i) {
            cin >> h >> w;
            s[h][w] += h * w;
        }
        for (int i = 1; i <= 1000; ++i) for (int j = 1; j <= 1000; ++j) 
            s[i][j] += s[i][j - 1] + s[i - 1][j] - s[i - 1][j - 1];
        
        for (int i = 0; i < q; ++i) {
            cin >> hs >> ws >> hb >> wb;
            cout << s[hb - 1][wb - 1] - s[hb - 1][ws] - s[hs][wb - 1] + s[hs][ws] << "\n";
        }
    }
}
```


## atcoder

### é¥²å–‚æ‰€æœ‰åŠ¨ç‰©çš„æœ€å°ä»£ä»·

[abc251 E](https://atcoder.jp/contests/abc251/tasks/abc251_e)

æœ‰nä¸ªåŠ¨ç‰©ï¼Œç¼–å·1åˆ°nã€‚æœ‰nç§å–‚åŠ¨ç‰©ç»„åˆï¼š

+ ä½¿ç”¨ a1 å…ƒ å¯ä»¥å–‚ åŠ¨ç‰©1å’ŒåŠ¨ç‰©2
+ ä½¿ç”¨ a2 å…ƒ å¯ä»¥å–‚ åŠ¨ç‰©2å’ŒåŠ¨ç‰©3
+ ...
+ ä½¿ç”¨ an å…ƒ å¯ä»¥å–‚ åŠ¨ç‰©nå’ŒåŠ¨ç‰©1

æ±‚æ‰€æœ‰åŠ¨ç‰©éƒ½å¾—åˆ°é¥²å–‚æ‰€éœ€è¦çš„æœ€å°ä»£ä»·ã€‚

+ 2 <= n <= 2e5
+ 1 <= ai <= 1e9

**åˆ†æ**

+ è€ƒè™‘ç¬¬nä¸ªï¼Œå¯ä»¥ä½¿ç”¨anå–‚ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨a1å–‚ã€‚
+ å¦‚æœä½¿ç”¨anå–‚ï¼Œåˆ™ a1å¯é€‰ï¼Œå¯ä¸é€‰
+ å¦‚æœä¸ä½¿ç”¨anå–‚ï¼Œåˆ™ a1å¿…é€‰ï¼Œa2å¯é€‰å¯ä¸é€‰ã€‚
+ s1[i] è¡¨ç¤ºå‰iä¸ªï¼Œä¸”é€‰ç¬¬iä¸ªçš„æœ€å°ä»£ä»·ï¼Œs2[i]è¡¨ç¤ºå‰iä¸ªï¼Œä¸”ä¸é€‰ç¬¬iä¸ªçš„æœ€å°ä»£ä»·
+ é€‰anæ—¶ï¼Œs1[0] = a[0], s2[0] = 0;
+ ä¸é€‰anï¼Œé€‰a1æ—¶ï¼Œs1[1] = a[1], s2[1] = 0;

```c++
long long minCost(vector<int> &a) {
    vector<long long> s1(n), s2(n);
    long long ans = 1e18;
    s1[0] = a[0], s2[0] = 0; // é€‰ç¬¬nä¸ªï¼Œåˆ™ç¬¬1ä¸ªå¯ä»¥é€‰æˆ–ä¸é€‰
    for (int i = 1; i < n - 1; ++i) {
        s1[i] = min(s2[i - 1], s1[i - 1]) + a[i];
        s2[i] = s1[i - 1];
    }
    ans = min(s1[n - 2], s2[n - 2]) + a[n - 1];
    s1[1] = a[1], s2[1] = 0;
    for (int i = 2; i < n; ++i) {
        s1[i] = min(s2[i - 1], s1[i - 1]) + a[i];
        s2[i] = s1[i - 1];
    }
    ans = min(ans, min(s1[n - 1], s2[n - 1]) + a[0]);
    return ans;
}
```

### å‰ç¼€é›†åˆæ˜¯å¦ç›¸ç­‰

[abc250 E](https://atcoder.jp/contests/abc250/tasks/abc250_e)

æœ‰ä¸¤ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„aå’Œbï¼Œæœ‰qä¸ªè¯¢é—®ï¼Œç¬¬iä¸ªè¯¢é—®ç»™å‡ºä¸¤ä¸ªæ•°xï¼Œyï¼Œåˆ¤æ–­açš„å‰xä¸ªæ•°ä¸bçš„å‰yä¸ªæ•°æ„æˆçš„é›†åˆæ˜¯å¦ç›¸ç­‰ã€‚

+ 1 <= n, q <= 2e5
+ 1 <= ai, bi <= 1e9
+ 1 <= xi, yi <= n

**æ–¹æ³•1:å“ˆå¸Œ**

```c++
using ull = unsigned long long;
vector<int> prefixSetEqual(vector<int>& a, vector<int>& b, vector<vector<int>>& q) {
    int n = a.size(), m = q.size();
    vector<int> ans(m);
    mt19937_64 rng(random_device{}()); 
    set<int> st1, st2;
    map<int, ull> mp;
    for (auto &x: a) if (!mp.count(x)) mp[x] = rng();
    for (auto &x: b) if (!mp.count(x)) mp[x] = rng();
    vector<ull> s1(n+1), s2(n+1);
    for(int i = 0; i < n; ++i) {
        s1[i + 1] = s1[i];
        if (!st1.count(a[i])) s1[i + 1] += mp[a[i]];
        st1.insert(a[i]);
    }
    for(int i = 0; i < n; ++i) {
        s2[i + 1] = s2[i];
        if (!st2.count(b[i])) s2[i + 1] += mp[b[i]];
        st2.insert(b[i]);
    }
    for (int i = 0; i < m; ++i) {
        if (s1[q[i][0] + 1] == s2[q[i][1] + 1]) ans[i] = 1;
    }
    return ans;
}
```

**æ–¹æ³•2**

+ å¯¹äº x = 1, 2, ... n, ä½¿å¾—æŸ¥è¯¢ (x,y) ä¸º `true` çš„ y å¦‚æœå­˜åœ¨ï¼Œä¸€å®šæ˜¯ä¸€ä¸ªç‰¹å®šåŒºé—´[l, r]ã€‚
+ l[x], r[x] è¡¨ç¤º ä½¿å¾—(x,y)ä¸ºtrueï¼Œçš„yçš„å·¦è¾¹ç•Œå’Œå³è¾¹ç•Œã€‚ä½¿ç”¨ä¸¤ä¸ªsetç»´æŠ¤ï¼Œå½“å‰å‰ç¼€a[i]å’Œb[j]é›†åˆæ˜¯å¦ç›¸ç­‰ã€‚
+ å¯¹äºæŸ¥è¯¢(x,y)ï¼Œå¦‚æœyåœ¨[l[x],r[x]]ä¸­ï¼Œåˆ™ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseã€‚


```c++
vector<int> prefixSetEqual(vector<int>& a, vector<int>& b, vector<vector<int>>& q) {
    int n = a.size(), m = q.size();
    vector<int> l(n, n), r(n, -1), ans(m);
    set<int> s1, s2;
    for (int i = 0, j = 0; i < n; ++i) {
        if (s1.count(a[i])) {
            l[i] = l[i - 1], r[i] = r[i - 1];
            continue;
        }
        s1.insert(a[i]);
        while (j < n && s1.size() != s2.size()) {
            if (!s1.count(b[j])) break;
            s2.insert(b[j++]);
        }
        if(s1.size() == s2.size()) {
            l[i] = j - 1;
            while (j < n && s2.count(b[j])) j++;
            r[i] = j - 1;
        }

    }
    for (int i = 0; i < m; ++i) {
        if (q[i][1] >= l[q[i][0]] && q[i][1] <= r[q[i][0]]) ans[i] = 1;
    }
    return ans;
}
```

### æœ€å€¼ä¸ºxyçš„æ•°å¯¹æ•°ç›®

[abc247 E](https://atcoder.jp/contests/abc247/tasks/abc247_e)

ç»™å®šæ•°ç»„ a=[a1,...,an],å’Œx,y. æ±‚æœ‰å¤šå°‘å¯¹(l,r)æ»¡è¶³å¦‚ä¸‹æ¡ä»¶

+ 1 <= l <= r <= n
+ max([al,... ar]) = x, min([al,... ar]) = y

+ 1 <= n <= 2e5
+ 1 <= ai <= 2e5
+ 1 <= y <= x <= 2e5

**æ–¹æ³•1:æ»‘åŠ¨çª—å£**

```c++
long long countMinMaxPairs(vector<int> &a, int x, int y) {
    int n = a.size(), cx = -1, cy = -1, t = -1;
    long long ans = 0;
    for (int i = 0; i < n; ++i) {
        if (a[i] > x || a[i] < y) {
            t = i, cx = cy = -1;
        }
        if (a[i] == x) cx = i;
        if (a[i] == y) cy = i;
        if (cx >= 0 && cy >= 0) ans += min(cx, cy) - t;
    }
    return ans;
}
``` 

**æ–¹æ³•2:å®¹æ–¥åŸç†**

ä»£ç å€Ÿé‰´è‡ªjianglyã€‚

```c++
long long countMinMaxPairs(vector<int> &a, int x, int y) {
    int n = a.size();
    auto get = [&](int x, int y) {
        long long ans = 0;
        for (int i = 0, j = 0; i < n; ++i) {
            if (a[i] > x || a[i] < y) j = i + 1;
            ans += i + 1 - j;
        }
        return ans;
    };
    return get(x, y) - get(x - 1, y) - get(x, y + 1) + get(x - 1, y + 1);
}
```

### æœ€çŸ­è·¯å¾„æ ‘

[abc 252 E](https://atcoder.jp/contests/abc252/tasks/abc252_e)

nä¸ªç‚¹(ç¼–å·1åˆ°n)mæ¡è¾¹(ç¼–å·1åˆ°m)çš„æ— å‘è¿é€šå›¾ï¼Œedge[i] = [ai,bi,ci],è¿æ¥ai,bi,è·ç¦»ä¸ºciï¼Œä»ä¸­é€‰æ‹©n-1æ¡è¾¹ï¼Œä½¿å›¾ä¾ç„¶è¿é€šï¼Œè®¾diè¡¨ç¤ºèŠ‚ç‚¹1åˆ°èŠ‚ç‚¹içš„è·ç¦»ï¼Œä½¿
d2+d3+...+dnæœ€å°åŒ–ã€‚

+ 2 <= n <= 2e5
+ n-1 <= m <= 2e5
+ 1 <= ai < bi < n
+ 1 <= ci <= 1e9

**åˆ†æ**

è®¾Diä¸ºåŸå§‹å›¾ä¸­èŠ‚ç‚¹1åˆ°èŠ‚ç‚¹içš„æœ€çŸ­è·¯ï¼Œæ˜¾ç„¶di>=Di, æ‰€ä»¥å¦‚æœå­˜åœ¨ä¸€ç§æ–¹æ¡ˆä½¿å¾—di=Diï¼Œ é‚£ä¹ˆè¿™ä¸ªæ–¹æ¡ˆä¸€å®šæ˜¯æœ€ä¼˜çš„ï¼Œ

å®é™…ä¸Šï¼Œè¿™ç§æ–¹æ¡ˆæ˜¯å­˜åœ¨çš„ï¼Œåªéœ€è¦ä¿å­˜ ä»èŠ‚ç‚¹1åˆ°èŠ‚ç‚¹içš„æœ€çŸ­è·¯å¾„ä¸­çš„æœ€åä¸€æ¡è·¯å¾„å³å¯ï¼Œè¿™ç§é€‰æ‹©æ–¹æ³•å¯ä»¥ä½¿å¾—di=Diã€‚

è¿™ç§é€‰æ‹©ç§°ä¸º**æœ€çŸ­è·¯å¾„æ ‘**

ç±»ä¼¼é¢˜ç›®ï¼Œ[cf545E paths and Trees](https://codeforces.com/contest/545/problem/E),
[acwingå‘¨èµ›2 p3](https://www.acwing.com/problem/content/3631/)


```c++
// nä¸ªèŠ‚ç‚¹(0-(n-1)ï¼Œ
// edges:è¾¹ (ai,bi,ci)ï¼Œ 0<=ai<bi<=n-1
// u:æ˜¯èµ·å§‹èŠ‚ç‚¹ã€‚0 <= u <= n-1
// å¦‚æœæœ‰å¤šç§æœ€çŸ­è·¯å¾„æ ‘ï¼Œè¿™é‡Œä¼šå–æ‰€é€‰çš„n-1æ¡è¾¹æƒå’Œæœ€å°çš„é‚£æ¡ã€‚
vector<int> shortestPathTree(int n, vector<vector<int>> &edges, int u) {
    vector<vector<int>> g(n);
    vector<int> ans(n);
    for (int i = 0; i < edges.size(); ++i) {
        g[edges[i][0]].push_back(i);
        g[edges[i][1]].push_back(i);
    }
    vector<long long> dis(n, 1e18);
    vector<bool> vis(n); 
    priority_queue<pair<long long, int> > pq;
    dis[u] = 0;
    pq.push({0, u});
    while (pq.size()) {
        int t = pq.top().second; pq.pop();
        if (vis[t]) continue;
        vis[t] = true;
        for (auto &v : g[t]) {
            int x = edges[v][0] + edges[v][1] - t, cost = edges[v][2];
            if (dis[t] + cost < dis[x]) {
                dis[x] = dis[t] + cost;
                ans[x] = v;
                pq.push({-dis[x], x});
            } else if (dis[t] + cost == dis[x] && edges[ans[x]][2] > edges[v][2]) {
                ans[x] = v;
            } 
        }
    }
    return ans;
}
```

### è‚¡ç¥¨äº¤æ˜“

[abc250 G](https://atcoder.jp/contests/abc250/tasks/abc250_g)
åŒ[cf865 D](https://codeforces.com/problemset/problem/865/D)

å·²çŸ¥æ¥ä¸‹æ¥nå¤©çš„è‚¡ç¥¨ä»·æ ¼ï¼Œæ¯å¤©ä½ å¯ä»¥ä¹°è¿›ä¸€åªè‚¡ç¥¨ï¼Œå–å‡ºä¸€åªè‚¡ç¥¨ï¼Œæˆ–è€…ä»€ä¹ˆä¹Ÿä¸åšã€‚nå¤©åä½ æ‰€æ‹¥æœ‰çš„é’±çš„æœ€å¤§å€¼æ˜¯å¤šå°‘ã€‚

**æ¨¡æ‹Ÿè´¹ç”¨æµ(åæ‚”è´ªå¿ƒ)**

æ¯ä¸€å¤©ï¼Œå¯ä»¥æœ‰ä¸¤ç§æ“ä½œ

+ æ‰¾åˆ°ä¹‹å‰æ²¡æ“ä½œçš„å¹¶ä¸”è‚¡ç¥¨æœ€ä¾¿å®œçš„ä¸€å¤©ï¼Œåœ¨é‚£å¤©ä¹°å…¥ï¼Œä»Šå¤©å–å‡º
+ å°†ä¹‹å‰çš„æŸä¸€æ¬¡æ“ä½œåæ‚”ã€‚æ¯”å¦‚ä»Šå¤©æ˜¯ç¬¬cå¤©ï¼Œä¹‹å‰æœ‰ä¸€ä¸ªæ“ä½œï¼šåœ¨ç¬¬a å¤©ä¹°å…¥ç¬¬b å¤©å–å‡ºï¼Œå°†åœ¨ç¬¬bå¤©å–å‡ºè¿™ä¸ªæ“ä½œåæ‚”ï¼Œä¸åœ¨ç¬¬bå¤©å–å‡ºï¼Œè€Œæ˜¯åœ¨ç¬¬cå¤©å–å‡ºï¼Œç„¶åæ ‡è®°ç¬¬bå¤©æ²¡æœ‰è¢«æ“ä½œè¿‡ã€‚

ä»”ç»†è§‚å¯Ÿåæ‚”æ“ä½œ

+ å‡å¦‚ä¹‹å‰æœ‰ä¸€ä¸ªæ“ä½œï¼šåœ¨ç¬¬aå¤©ä¹°å…¥ç¬¬bå¤©å–å‡ºï¼Œé‚£ä¹ˆå®ƒçš„è´¡çŒ®æ˜¯fa-fbã€‚
+ ç„¶åè€ƒè™‘åæ‚”ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å°†ç¬¬bå¤©çš„è´¡çŒ®å‡å»ï¼Œç„¶ååŠ ä¸Šç¬¬cå¤©çš„è´¡çŒ®ï¼Œä¹Ÿå°±æ˜¯åŠ ä¸Š fc-fb

```c++
#include<bits/stdc++.h>
using namespace std;

int main(){
  int n; cin >> n;
  vector<long long> a(n);
  for(auto &nx : a){cin >> nx;}
  long long res=0;
  priority_queue<long long,vector<long long>,greater<long long>> pq;
  pq.push(a[0]);
  for(int i = 1; i < n; i++){
    if(pq.top() < a[i]){
      res += (a[i]-pq.top());
      pq.pop();
      pq.push(a[i]);
    }
    pq.push(a[i]);
  }
  cout << res << '\n';
  return 0;
}

```

### æ»¡è¶³å…ˆåºéå†åºåˆ—çš„æ•°é‡

Nä¸ªèŠ‚ç‚¹çš„æœ‰æ ¹æ ‘ï¼ŒèŠ‚ç‚¹ç¼–å·1-Nï¼Œ1æ˜¯æ ¹èŠ‚ç‚¹ï¼Œå¯¹æ ‘è¿›è¡Œdfsï¼Œå¾—åˆ°çš„ç»“æœä¸º p1,...pn,
éå†æ—¶ï¼Œå¦‚æœå½“å‰æœ‰å¤šä¸ªå­èŠ‚ç‚¹ï¼Œå…ˆéå†ç¼–å·æœ€å°çš„ã€‚

æ±‚æœ‰å¤šå°‘ç§æœ‰æ ¹æ ‘çš„å…ˆåºéå†æ»¡è¶³è¯¥ç»“æœåºåˆ—ã€‚æ¨¡998244353ã€‚

+ 2 <= n <= 500
+ 1 <= pi <= n
+ p1,...pnæ˜¯1-nçš„æ’åˆ—ï¼Œ ä¸”p1 =1

**åˆ†æ**

æ·»åŠ ä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹0.

dp[l][r] (2<=l<=r<=n+1) è¡¨ç¤º:

+ æœ‰r-l+1ä¸ªèŠ‚ç‚¹ï¼Œ0ï¼ŒAl,...Ar, æ ¹èŠ‚ç‚¹æ˜¯èŠ‚ç‚¹0ï¼Œ
+ 0ï¼ŒAl, ... Arçš„å…ˆåºç»“æœä¸é¢˜ç›®æè¿°çš„ä¸€è‡´çš„æ–¹æ¡ˆæ•°

æˆ‘ä»¬è¦æ±‚çš„æ˜¯ dp[2][N+1]ï¼Œ

+ å½“l=ræ—¶ï¼Œdp[l][r]=1
+ å¦åˆ™
  + å¦‚æœA[l] æ˜¯ 0çš„å”¯ä¸€å­èŠ‚ç‚¹ï¼Œåˆ™å…¶ä»–èŠ‚ç‚¹éƒ½æ˜¯A[l]çš„å­èŠ‚ç‚¹ï¼Œæ–¹æ¡ˆæ•°ä¸ºdp[l+1][k]
  + å¦‚æœ0æœ‰å…¶ä»–å­èŠ‚ç‚¹ï¼Œå‡è®¾ä¸‹ä¸€ä¸ªæœ€å°çš„èŠ‚ç‚¹ä¸ºA[k],åˆ™A[l]å­èŠ‚ç‚¹çš„æ–¹æ¡ˆæ•°ä¸ºdp[l+1][k]
,å»æ‰A[l]åŠå…¶å­èŠ‚ç‚¹ï¼Œæœ‰dp[k][r]ç§æ ‘çš„æ–¹æ¡ˆã€‚æ‰€ä»¥å¯ä»¥ä½¿ç”¨åŒºé—´dpã€‚


```c++
#include <bits/stdc++.h>
using namespace std;
const int MOD = 998244353;

int main() {
    int n; cin >> n;
    int a[500];
    long long dp[501][501];
    for (int i = 0; i < n; i++) cin >> a[i];

    for (int l = n; l >= 1; l--) {
        dp[l][l] = 1;
        for (int r = l + 1; r <= n; r++) {
            dp[l][r] = dp[l + 1][r];
            for (int k = l + 1; k < r; k++) {
                if (a[l] < a[k])dp[l][r] = (dp[l][r] + (dp[l + 1][k] * dp[k][r])) % MOD;
            }
        }
    }

    cout << dp[1][n] << endl;
    return 0;
}

```

### æœ€å¤šå¥–é‡‘æ•°

[abc261 D](https://atcoder.jp/contests/abc261/tasks/abc261_d)

ä»ä¸€æšç¡¬å¸næ¬¡ï¼ŒåŒæ—¶æœ‰ä¸ªè®¡æ•°å™¨ï¼Œåˆå§‹ä¸º0.

+ å¦‚æœç¬¬iæ¬¡ä¸ºæ­£é¢ï¼Œè®¡æ•°å™¨+1ï¼ŒåŒæ—¶è·å¾—x[i]å¥–é‡‘ã€‚
+ å¦‚æœç¬¬iæ¬¡ä¸ºåé¢ï¼Œè®¡æ•°å™¨æ¸…é›¶ï¼Œæ— å¥–é‡‘ã€‚

å¦å¤–è¿˜æœ‰mç§è¿èƒœå¥–é‡‘ï¼Œç¬¬iç§ï¼Œæ¯å½“è®¡æ•°å™¨ä¸ºc[i]æ—¶ï¼Œå¯ä»¥è·å¾—y[i]å¥–é‡‘ã€‚

æ±‚èƒ½è·å¾—çš„æœ€å¤šå¥–é‡‘æ•°é‡ã€‚

+ 1 <= m <= n <= 5000
+ 1 <= x[i],y[i] <= 1e9
+ 1 <= c[i] <= N
+ c[1],c[2],,,c[m] äº’ä¸ç›¸åŒ

**åˆ†æ**

dp[i][j]è¡¨ç¤ºæ‰”äº†å‰iæ¬¡ç¡¬å¸ï¼Œæœ€ç»ˆçš„è®¡æ•°å™¨ä¸ºjæ—¶è·å¾—çš„æœ€å¤§å¥–é‡‘ï¼Œ

+ å¦‚æœj>0, dp[i+1][j]=dp[i][j-1]+x[i+1]+w[j]
+ å¦‚æœj=0ï¼Œè¯´æ˜ç¬¬i+1æ¬¡æ˜¯åé¢ï¼Œdp[i+1][0]=max(dp[i][j])

æ—¶é—´å¤æ‚åº¦O(n^2)

```c++
#include <bits/stdc++.h>
using namespace std;
int main() {
    int n, m;
    cin >> n >> m;
    vector<long long> x(n + 1), w(n + 1);
    vector<vector<long long>> dp(n + 1, vector<long long> (n + 1, -1e18));
    dp[0][0] = 0;

    for (int i = 1; i <= n; ++i) cin >> x[i];

    for (int i = 0, x, y; i < m; ++i) {
        cin >> x >> y;
        w[x] = y;
    }

    for (int i = 1; i <= n; ++i) {
        for (int j = 1; j <= i; ++j) 
            dp[i][j] = dp[i - 1][j - 1] + x[i] + w[j];
        dp[i][0] = 0;
        for (int j = 0; j < i; ++j)
            dp[i][0] = max(dp[i][0], dp[i - 1][j]);
    }

    cout << *max_element(dp[n].begin(), dp[n].end()) << "\n";
}
```

### æ¯æ¬¡æ“ä½œåçš„å€¼

[abc261 E](https://atcoder.jp/contests/abc261/tasks/abc261_e)

æœ‰ä¸ªå˜é‡xå’Œnç§æ“ä½œï¼Œç¬¬iç§æ“ä½œè¡¨ç¤ºä¸º(t[i], a[i])

+ å¦‚æœ t = 1, æ“ä½œ x = x & a[i]
+ å¦‚æœ t = 2, æ“ä½œ x = x | a[i]
+ å¦‚æœ t = 3, æ“ä½œ x = x ^ a[i]

x åˆå§‹å€¼ä¸º c, æŒ‰é¡ºåºæ‰§è¡Œå¦‚ä¸‹æ­¥éª¤ï¼š

+ æ‰§è¡Œæ“ä½œ1ï¼Œè¾“å‡ºxçš„ç»“æœ
+ æ‰§è¡Œæ“ä½œ1ï¼Œ2ï¼Œè¾“å‡ºxçš„ç»“æœ
+ ...
+ æŒ‡å®šæ“ä½œ1,2,...,n è¾“å‡ºxçš„ç»“æœ

+ 1 <= N <= 2e5
+ 1 <= t[i] <= 3
+ 0 <= a[i] <= 2^30
+ 0 <= c <= 2^30

**æ–¹æ³•1**

æ¯ä¸€ä½æ“ä½œæ˜¯ç‹¬ç«‹çš„ï¼Œå¯ä»¥æŒ‰ä½è€ƒè™‘ã€‚

```c++
#include<bits/stdc++.h>
using namespace std;
#define bit(x,i) (((x)>>(i))&1)

int main() {
    int n, c, x, a, t; 
    cin >> n >> c;

    vector<int> ans(n);
    vector<array<int, 2>> op(n);

    for (int i = 0; i < n; ++i) 
        cin >> op[i][0] >> op[i][1];

    for (int k = 0; k < 30; ++k) {
        array<int, 2> func = {0, 1};
        int b = bit(c, k);
        for (int i = 0; i < n; ++i) {
            array<int, 2> f;
            int t = op[i][0], a = op[i][1], x = bit(a, k);
            if (t == 1) f = {0 & x, 1 & x};
            if (t == 2) f = {0 | x, 1 | x};
            if (t == 3) f = {0 ^ x, 1 ^ x};
            func = {f[func[0]], f[func[1]]};
            b = func[b];
            ans[i] |= b << k;
        }
    }
    
    for (int i = 0; i < n; ++i)
        cout << ans[i] << "\n";
}
```

**æ–¹æ³•2**

```c++
#include<bits/stdc++.h>
using namespace std;
#define bit(x,i) (((x)>>(i))&1)

int main() {
    int n, x, s0 = 0, s1 = (1 << 30) - 1, m = s1;
    cin >> n >> x;
    for (int i = 0, t, a; i < n; ++i) {
        cin >> t >> a;
        if (t == 1) s1 &= a, s0 &= a;
        else if (t == 2) s1 |= a, s0 |= a;
        else s1 ^= a, s0 ^= a;
        x = (x & s1) | ((x ^ m) & s0);
        cout << x << "\n";
    }
}
```

### å‡å€¼ä¸ºæ•´æ•°çš„å­åºåˆ—æ•°é‡

[abc263 d](https://atcoder.jp/contests/abc262/tasks/abc262_d)

é•¿åº¦ä¸ºnçš„æ•´æ•°æ•°ç»„ï¼Œå…±æœ‰ 2^n-1ä¸ªéç©ºå­åºåˆ—ï¼Œè¿™äº›å­åºåˆ—ä¸­æœ‰å¤šå°‘ä¸ªå­åºåˆ—çš„å¹³å‡å€¼æ˜¯ä¸ªæ•´æ•°ï¼Œç­”æ¡ˆæ¨¡998244353ã€‚

+ 1 <= n <= 100
+ 1 <= a[i] <= 1e9

**åˆ†æ**

å¯¹äº i=i,2,,,N

dp[j][k][l] è¡¨ç¤ºå‰jä¸ªä¸­é€‰kä¸ªï¼Œæ¨¡iç­‰äºlçš„æ–¹æ¡ˆæ•°é‡ã€‚


```c++
mint ans = 0;

for (int i = 1; i <= n; ++i) {
    vector dp(n + 1,vector(i + 1, vector<mint>(i)));
    dp[0][0][0] = 1;
    for (int j = 0; j < n; ++j) {
        for (int k = 0; k <= i; ++k) {
            for (int l = 0; l < i; ++l) {
                dp[j + 1][k][l] += dp[j][k][l];
                if (k != i) dp[j + 1][k + 1][(l + a[j]) %i] += dp[j][k][l];
            }
        }
    }
    ans += dp[n][i][0];
}
cout << ans << "\n";
```


## dpcontest


### æ­£é¢å¤šäºåé¢çš„æ¦‚ç‡

[dp contest I](https://atcoder.jp/contests/dp/tasks/dp_i)

æœ‰Nä¸ªç¡¬å¸ï¼Œç¬¬iä¸ªç¡¬å¸æŠ›å‡ºå»æ­£é¢å‘ä¸Šçš„æ¦‚ç‡ä¸ºpi, å°†Nä¸ªç¡¬å¸å…¨éƒ¨æŠ›å‡ºï¼Œæ­£é¢å‘ä¸Šçš„ç¡¬å¸æ•°æ‰€æ¬²åé¢çš„æ¦‚ç‡ã€‚

+ 1 <= N <= 2999ï¼Œä¸”Næ˜¯ä¸ªå¥‡æ•°
+ 0 < pi < 1

**åˆ†æ**

dp[i][j] è¡¨ç¤ºå‰iä¸ªç¡¬å¸ï¼Œå‡ºç°jä¸ªæ­£é¢å‘ä¸Šçš„æ¦‚ç‡ã€‚

åˆ™å¯¹äºç¬¬iä¸ªç¡¬å¸

+ å‡ºç° 0 ä¸ª æ­£é¢ç¡¬å¸çš„æ¦‚ç‡ä¸º dp[i][j] = dp[i - 1][j] * (1.0 - p[i])
+ å‡ºç°j(j>0)ä¸ªæ­£é¢ç¡¬å¸åˆ†ä¸¤ç§æƒ…å†µ
    - ç¬¬iä¸ªæ˜¯æ­£é¢ï¼Œæ¦‚ç‡ä¸ºp[i],å‰i-1ä¸ªå‡ºç°j-1ä¸ªæ­£é¢ã€‚ dp[i][j] += dp[i - 1][j - 1] * p[i];
    - ç¬¬iä¸ªæ˜¯åé¢ï¼Œå‰i-1ä¸ªå‡ºç°jä¸ªæ­£é¢ï¼Œdp[i][j] += dp[i - 1][j] * (1.0 - p[i]);


```c++
double calProb(vector<double>& p){
    int n = p.size();
    vector dp(n + 1, vector<double>(n + 1));
    dp[0][0] = 1;
    for (int i = 1; i <= n; ++i) {
        for (int j = 0; j <= i; ++j) {
            if (j == 0) dp[i][j] = dp[i - 1][j] * (1.0 - p[i - 1]);
            else {
                dp[i][j] += dp[i - 1][j - 1] * p[i - 1];
                dp[i][j] += dp[i - 1][j] * (1.0 - p[i - 1]);
            }
        }
    }
    double ans = 0.0;
    for (int i = (n + 1) / 2; i <= n; ++i) 
        ans += dp[n][i];
    return ans;

}
```

### æœ‰å‘å›¾ä¸­æœ€é•¿è·¯å¾„

[dp contest G](https://atcoder.jp/contests/dp/tasks/dp_g)

ç»™ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼Œæ±‚å›¾ä¸­æœ€é•¿çš„è·¯å¾„ï¼Œè·¯å¾„é•¿åº¦ä¸ºè¾¹çš„æ•°ç›®ã€‚

**åˆ†æ**

dfs + dp,
dfsæ—¶å…ˆdfs æŒ‡å‘çš„èŠ‚ç‚¹ï¼Œå†æŠŠå½“å‰å…ƒç´ æ”¾å…¥æ•°ç»„ï¼Œä¿è¯æ¯ä¸ªç‚¹çš„å­èŠ‚ç‚¹éƒ½åœ¨æ”¹ç‚¹ä¹‹å‰å‡ºç°ã€‚
dpæ—¶ï¼Œå¯¹äºæ¯ä¸ªç‚¹è¿æ¥çš„æ‰€æœ‰ç‚¹ï¼Œdp[v] =  max(dp[v], dp[u] + 1)å³å¯

```c++
int calLongestPath(vector<vector<int>> &g) {
    int n = g.size(), ans = 0;
    vector<int> vis(n), a, dp(n);

    function<void(int)> dfs = [&](int v){
        if(vis[v]) return;
        vis[v] = 1;
        for(int u : g[v]) dfs(u);
        a.push_back(v);
    };

    for (int i = 0; i < n; ++i) dfs(i);

    for(auto &v : a) for (auto &u : g[v]) 
        dp[v] = max(dp[v], dp[u] + 1), ans = max(ans, dp[v]);
    return ans;
}
```


### åƒå®Œæ‰€æœ‰å¯¿å¸çš„æœŸæœ›æ“ä½œæ¬¡æ•°

[dp contest J](https://atcoder.jp/contests/dp/tasks/dp_j)

nä¸ªç›˜å­ï¼Œæ¯ä¸ªç›˜å­æœ‰ai (1 <= ai <= 3) ä¸ªå¯¿å¸, æ¯æ¬¡æ“ä½œä»1-nä¸­éšæœºé€‰æ‹©ä¸€ä¸ªç›˜å­ï¼Œå¦‚æœé€‰ä¸­çš„ç›˜å­ä¸­æœ‰å¯¿å¸ï¼Œåƒæ‰å…¶ä¸­ä¸€ä¸ªï¼Œå¦åˆ™ä»€ä¹ˆä¹Ÿä¸åšã€‚

æ±‚åƒå®Œæ‰€æœ‰å¯¿å¸çš„æœŸæœ›æ“ä½œæ¬¡æ•°æ˜¯å¤šå°‘ã€‚

+ 1 <= n <= 300

**åˆ†æ**

dp[i][j][k] è¡¨ç¤º1ä¸ªå¯¿å¸çš„ç›˜å­æœ‰iä¸ªï¼Œ2ä¸ªå¯¿å¸çš„ç›˜å­æœ‰jä¸ªï¼Œ3ä¸ªå¯¿å¸çš„ç›˜å­æœ‰kä¸ªçš„æœŸæœ›æ“ä½œæ¬¡æ•°ã€‚

åˆ™å¯¹äº dp[i][j][k], æ€»å…±å«æœ‰å¯¿å¸çš„ç›˜å­ä¸º `t = i + j + k` ä¸ªï¼Œæœ€åä¸€æ¬¡æ“ä½œé€‰ä¸­tä¸ªç›˜å­ä¸­çš„ä¸€ä¸ªçš„æœŸæœ›æ¬¡æ•°ä¸º n / t; 
åœ¨è¿™tä¸ªç›˜å­ä¸­ã€‚

+ å¦‚æœæ˜¯iä¸ªç›˜å­ä¸­çš„ä¸€ä¸ªï¼šdp[i][j][k] += dp[i - 1][j][k] * i / n
+ å¦‚æœæ˜¯jä¸ªç›˜å­ä¸­çš„ä¸€ä¸ª: dp[i][j][k] += dp[i + 1][j - 1][k] * j / n; å› ä¸ºé€‰ä¸­ç›˜å­ä¸Šæœ‰2ä¸ªå¯¿å¸ï¼Œåƒæ‰ä¸€ä¸ªåï¼Œjä¼š-1ï¼Œä½†iä¼š+1ï¼Œå¤šäº†ä¸€ä¸ªæœ‰1ä¸ªå¯¿å¸çš„ç›˜å­ã€‚
+ å¦‚æœæ˜¯kä¸ªç›˜å­ä¸­çš„ä¸€ä¸ª: dp[i][j][k] += dp[i][j + 1][k - 1] * k / n;

```c++
const int M = 305;
double dp[M][M][M];
void solve(){
    cin>>n;
    vector<int> a(3);
    for (int i = 0; i < n; ++i){
        cin>>x;
        a[--x]++;
    }
    dp[0][0][0] = 0.0;
    for (int k = 0; k <= a[2]; ++k) 
        for (int j = 0; j <= n; ++j) 
            for (int i = 0; i <= n; ++i) {
                if (i + j + k == 0) continue;
                dp[i][j][k] = 1.0;
                if (i) dp[i][j][k] += dp[i - 1][j][k] * i / n;
                if (j) dp[i][j][k] += dp[i + 1][j - 1][k] * j / n;
                if (k) dp[i][j][k] += dp[i][j + 1][k - 1] * k / n;
                dp[i][j][k] *= n * 1.0 / (i + j + k);
            }

    cout << dp[a[0]][a[1]][a[2]] << "\n";
}
```

### çŸ³å­æ¸¸æˆ

[dp contest K](https://atcoder.jp/contests/dp/tasks/dp_k)

æ•°ç»„aåŒ…å«nä¸ªæ­£æ•´æ•°ï¼Œæœ‰ä¸€å †åŒ…å«kä¸ªçš„çŸ³å­ï¼Œä¸¤äººè½®æµè¿›è¡Œå¦‚ä¸‹æ“ä½œã€‚

æ¯æ¬¡é€‰å–aä¸­çš„ä¸€ä¸ªå…ƒç´ xï¼Œä»çŸ³å­ä¸­ç§»é™¤xä¸ªçŸ³å­ï¼Œé‡‡å–æœ€ä¼˜ç­–ç•¥æ¡ä»¶ä¸‹ï¼Œå…ˆæ‰‹æ˜¯å¦å¿…èƒœã€‚

+ 1 <= n <= 100
+ 1 <= k <= 1e5
+ 1 <= a1 < a2 < ... < an <= k

**åˆ†æ**

dp[i] è¡¨ç¤ºå‰©iä¸ªçŸ³å­æ—¶ï¼Œå…ˆæ‰‹æ˜¯å¦å¿…èƒœï¼Œåˆ™å¯¹aä¸­çš„å…ƒç´ jï¼Œå¦‚æœi>=j å¹¶ä¸” dp[i-j]éå¿…èƒœï¼Œç”±äºæ˜¯è½®æµæ“ä½œï¼Œåˆ™iæ˜¯å¿…èƒœçŠ¶æ€ã€‚

```c++
bool check(vector<int> &a, int k) {
    vector<bool> dp(k + 1);
    for (int i = 1; i <= k; ++i) 
        for (auto &j : a) 
            if (i >= j && !dp[i - j]) dp[i] = 1;
    return dp[k];
}
```

### å…ˆæ‰‹åæ‰‹å¾—åˆ†å·®

[dp contest L](https://atcoder.jp/contests/dp/tasks/dp_l)

ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œä¸¤ä¸ªäººè½®æµè¿›è¡Œå¦‚ä¸‹æ“ä½œã€‚

+ ä»æ•°ç»„çš„å¼€å¤´æˆ–ç»“å°¾åˆ æ‰ä¸€ä¸ªå…ƒç´ ï¼Œå¾—åˆ†ä¸ºåˆ æ‰å…ƒç´ çš„å€¼ã€‚

è®¾å…ˆæ‰‹å¾—åˆ†ä¸ºxï¼Œåæ‰‹å¾—åˆ†ä¸ºyï¼Œå…ˆæ‰‹æœ€å¤§åŒ–x-yï¼Œåæ‰‹æœ€å°åŒ–x-yï¼Œæœ€ä¼˜ç­–ç•¥ä¸‹ï¼Œæ±‚x-yçš„ç»“æœã€‚

+ 1 <= n <= 3000
+ 1 <= ai <= 1e9

**åˆ†æ**

è®¾ dp[i][j] æ˜¯ ä»iåˆ°jåæ‰‹èƒ½å–å¾—çš„æœ€ä¼˜å¾—åˆ†ã€‚ å¯¹äºåŒºé—´i,jï¼Œè¦ä¹ˆé€‰a[i]ï¼Œæˆ–è€…a[j]ï¼Œæ‰€ä»¥

dp[i][j] = max(a[i] - dp[i+1][j], a[j]-dp[i][j-1]);


```c++
long long calc(vector<int> &a){
    int n = a.size();
    vector dp(n, vector<long long>(n));
    for(int l = 1; l <= n; ++l) 
        for (int i = 0; i + l <= n; ++i) {
            int j = i + l - 1;
            if (l == 1) dp[i][j] = a[i];
            else dp[i][j] = max(a[i] - dp[i+1][j], a[j] - dp[i][j-1]);
        }
    return dp[0][n-1];
}
```

### åˆ†ç³–æœæ–¹æ¡ˆæ•°

[dp contest M](https://atcoder.jp/contests/dp/tasks/dp_m)

ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œæœ‰kä¸ªç³–æœï¼Œå°†è¿™kä¸ªç³–æœæ­£å¥½åˆ†ç»™nä¸ªäººï¼Œç¬¬iä¸ªäººå¯ä»¥åˆ†0åˆ°aiä¸ªç³–æœï¼Œæ€»å…±æœ‰å¤šå°‘ç§æ–¹æ¡ˆ(mod 1e9 + 7)ã€‚

+ 1 <= n <= 100
+ 0 <= k <= 1e5
+ 1 <= ai <= k

**åˆ†æ**

dp[i][j] è¡¨ç¤ºå°†jä¸ªç³–æœåˆ†ç»™å‰iä¸ªäººçš„æ–¹æ¡ˆæ•°ï¼Œå…¶ä¸­ç¬¬iä¸ªäººå¯ä»¥åˆ†0åˆ°a[i]ä¸ªç³–æœï¼Œæ‰€ä»¥

dp[i][j] = dp[i-1][j] + dp[i-1][j-1] + ... + dp[i-1][j-a[i]]

ä½¿ç”¨å‰ç¼€å’Œä¼˜åŒ–ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(NK)

```c++
int cal(vector<int> &a,int k){
    int n=sz(a), M = 1e9 + 7;
    vector dp(n + 1,vector<long long>(k + 1));
    dp[0][0] = 1;
    for (int i = 0; i < n; ++i) {
        long long  s = 0;
        for (int j = 0; j <= k; ++j) {
            s += dp[i][j];
            if (j > a[i]) s -= dp[i][j - a[i] - 1];
            dp[i + 1][j] = (s % M + M) % M;

        }
    }
    return dp[n][k];
}
```